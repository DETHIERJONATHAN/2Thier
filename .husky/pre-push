#!/bin/sh
echo "ğŸ”§ Build automatique avant push..."

# Build uniquement le serveur API (plus rapide et essentiel)
npm run build:server
if [ $? -ne 0 ]; then
  echo "âŒ Build serveur Ã©chouÃ© ! Push annulÃ©."
  exit 1
fi
echo "âœ… Build serveur rÃ©ussi !"

# VÃ©rifier si dist-server a changÃ©
if ! git diff --quiet dist-server/ 2>/dev/null; then
  echo "ğŸ“¦ dist-server modifiÃ©, ajout au commit..."
  git add dist-server/
  git commit --amend --no-edit
  echo "âœ… Commit mis Ã  jour avec dist-server"
fi

echo "ï¿½ï¿½ Push autorisÃ© !"
