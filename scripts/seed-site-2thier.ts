/**
 * üå± SEED COMPLET SITE VITRINE 2THIER
 * 
 * Cr√©e TOUTES les donn√©es dans Prisma pour que l'√©diteur et les renderers
 * affichent parfaitement le site vitrine 2Thier.
 * 
 * @author IA Assistant - 9 octobre 2025
 */

import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
  console.log('üå± [SEED] Site Vitrine 2Thier - D√©but...\n');

  // 1Ô∏è‚É£ Trouver l'organisation 2Thier CRM
  let org = await prisma.organization.findFirst({
    where: { name: '2Thier CRM' }
  });

  if (!org) {
    console.log('‚ö†Ô∏è  Organisation "2Thier CRM" introuvable, cr√©ation...');
    org = await prisma.organization.create({
      data: {
        name: '2Thier CRM',
        description: 'Organisation principale CRM',
        website: 'https://www.2thier.com',
        phone: '+32 470 00 00 00'
      }
    });
  }

  console.log(`üè¢ Organisation : ${org.name} (${org.id})\n`);

  // 2Ô∏è‚É£ Cr√©er ou r√©cup√©rer le site
  console.log('üìÑ Cr√©ation/mise √† jour du site...');
  
  let website = await prisma.webSite.findFirst({
    where: {
      organizationId: org.id,
      slug: 'site-vitrine-2thier'
    }
  });

  if (website) {
    console.log(`‚ÑπÔ∏è  Site existant trouv√© (ID: ${website.id}), suppression pour recr√©ation propre...`);
    await prisma.webSite.delete({ where: { id: website.id } });
  }

  website = await prisma.webSite.create({
    data: {
      organizationId: org.id,
      siteName: '2THIER ENERGY',
      siteType: 'vitrine',
      slug: 'site-vitrine-2thier',
      domain: 'www.2thier.be',
      isActive: true,
      isPublished: true,
      maintenanceMode: false
    }
  });

  console.log(`‚úÖ Site cr√©√© : ${website.siteName} (ID: ${website.id})\n`);

  // 3Ô∏è‚É£ Configuration du site
  console.log('‚öôÔ∏è  Cr√©ation de la configuration...');
  await prisma.webSiteConfig.create({
    data: {
      websiteId: website.id,
      primaryColor: '#10b981',
      secondaryColor: '#059669',
      phone: '071/XX.XX.XX',
      email: 'info@2thier.be',
      address: 'Route de Gosselies 23',
      city: 'Fleurus',
      postalCode: '6220',
      country: 'Belgique',
      metaTitle: '2Thier Energy - Transition √ânerg√©tique en Wallonie',
      metaDescription: 'Photovolta√Øque, batteries, bornes de recharge, pompes √† chaleur. +500 installations r√©alis√©es.',
      stats: {
        installations: 500,
        powerMW: 15,
        satisfaction: 4.9,
        region: 'Wallonie'
      },
      valuesJson: [
        {
          icon: 'SafetyCertificateOutlined',
          title: 'Qualit√© Certifi√©e',
          description: 'Installateurs certifi√©s RESCERT et Agr√©gation Classe 1'
        },
        {
          icon: 'StarFilled',
          title: '4.9/5 de Satisfaction',
          description: 'Plus de 124 avis clients v√©rifi√©s sur Google'
        },
        {
          icon: 'CustomerServiceOutlined',
          title: 'SAV & Garanties',
          description: 'Service apr√®s-vente r√©actif et garanties longue dur√©e'
        },
        {
          icon: 'CheckCircleOutlined',
          title: 'Cl√© en Main',
          description: 'De l\'√©tude √† l\'installation, nous g√©rons tout'
        }
      ],
      businessHours: {
        lundi: '8h-18h',
        mardi: '8h-18h',
        mercredi: '8h-18h',
        jeudi: '8h-18h',
        vendredi: '8h-18h'
      },
      socialLinks: {
        facebook: 'https://facebook.com/2thier',
        linkedin: 'https://linkedin.com/company/2thier'
      }
    }
  });
  console.log('‚úÖ Configuration cr√©√©e\n');

  // 4Ô∏è‚É£ SECTIONS du site (Header, Hero, Stats, etc.)
  console.log('üìê Cr√©ation des sections...');

  const sections = [
    {
      key: 'header',
      type: 'header',
      name: 'En-t√™te',
      displayOrder: 1,
      isLocked: true,
      content: {
        logo: {
          type: 'text',
          text: '‚ö° 2THIER ENERGY',
          color: '#10b981',
          fontSize: '24px'
        },
        navigation: {
          links: [
            { text: 'Accueil', href: '#hero' },
            { text: 'Solutions', href: '#services' },
            { text: 'R√©alisations', href: '#projects' },
            { text: 'T√©moignages', href: '#testimonials' },
            { text: 'Contact', href: '#contact' }
          ]
        },
        cta: {
          text: 'DEVIS GRATUIT',
          href: '#contact',
          style: { backgroundColor: '#10b981', borderColor: '#10b981' }
        },
        style: {
          position: 'fixed',
          backgroundColor: 'rgba(255, 255, 255, 0.98)',
          boxShadow: '0 2px 8px rgba(0,0,0,0.06)'
        }
      }
    },
    {
      key: 'hero',
      type: 'hero',
      name: 'Section h√©ro',
      displayOrder: 2,
      content: {
        title: {
          text: 'üåû Votre Partenaire en Transition √ânerg√©tique',
          color: 'white',
          fontSize: 'clamp(32px, 8vw, 56px)'
        },
        subtitle: {
          text: 'Photovolta√Øque ‚Ä¢ Batteries ‚Ä¢ Bornes de Recharge ‚Ä¢ Pompes √† Chaleur\nIsolation ‚Ä¢ Toiture ‚Ä¢ √âlectricit√© ‚Ä¢ Gros ≈íuvre',
          color: 'rgba(255,255,255,0.95)',
          fontSize: 'clamp(16px, 4vw, 20px)'
        },
        primaryButton: {
          text: 'DEMANDER UN DEVIS GRATUIT',
          href: '#contact',
          icon: 'RocketOutlined',
          style: {
            padding: '16px 32px',
            fontSize: '18px',
            backgroundColor: 'white',
            color: '#10b981'
          }
        },
        secondaryButton: {
          text: 'NOS R√âALISATIONS',
          href: '#projects',
          style: {
            padding: '16px 32px',
            fontSize: '18px',
            borderColor: 'white',
            color: 'white',
            backgroundColor: 'rgba(255,255,255,0.1)'
          }
        },
        footer: {
          text: '+500 installations r√©alis√©es ‚Ä¢ 4.9/5 de satisfaction',
          icon: 'CheckCircleOutlined',
          color: 'rgba(255,255,255,0.9)'
        },
        style: {
          background: 'linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%)',
          minHeight: '600px',
          padding: '60px 24px'
        }
      }
    },
    {
      key: 'stats',
      type: 'stats',
      name: 'Statistiques',
      displayOrder: 3,
      content: {
        items: [
          { icon: 'HomeOutlined', value: 500, prefix: '+', label: 'Installations r√©alis√©es' },
          { icon: 'ThunderboltOutlined', value: 15, suffix: ' MW', label: 'Puissance install√©e' },
          { icon: 'StarFilled', value: 4.9, suffix: '/5', label: 'Satisfaction client' },
          { icon: 'EnvironmentOutlined', value: 'Wallonie', label: 'R√©gion couverte' }
        ],
        style: { backgroundColor: '#f9fafb', padding: '60px 24px' }
      }
    },
    {
      key: 'services',
      type: 'services',
      name: 'Nos Solutions',
      displayOrder: 4,
      content: {
        title: {
          text: 'üîÜ Nos Solutions √ânerg√©tiques',
          fontSize: 'clamp(28px, 6vw, 42px)'
        },
        subtitle: {
          text: 'Un √©cosyst√®me complet pour votre autonomie √©nerg√©tique',
          fontSize: '18px',
          color: '#64748b'
        },
        items: [
          {
            icon: { name: 'ThunderboltOutlined' },
            title: 'Photovolta√Øque',
            description: 'Installation de panneaux solaires haute performance',
            features: ['√âtude gratuite', 'Garantie 25 ans', 'Monitoring temps r√©el', 'Primes & fiscales'],
            button: { text: 'En savoir plus', href: '#contact' }
          },
          {
            icon: { name: 'ThunderboltOutlined' },
            title: 'Batteries',
            description: 'Stockage d\'√©nergie pour autoconsommation',
            features: ['Autonomie jour & nuit', 'Compatible onduleurs', 'Extension modulaire', 'Garantie 10 ans'],
            button: { text: 'En savoir plus', href: '#contact' }
          },
          {
            icon: { name: 'HomeOutlined' },
            title: 'Bornes de Recharge',
            description: 'Rechargez votre v√©hicule √©lectrique',
            features: ['Installation certifi√©e', 'Bornes intelligentes', 'Gestion app mobile', 'Primes disponibles'],
            button: { text: 'En savoir plus', href: '#contact' }
          },
          {
            icon: { name: 'SafetyOutlined' },
            title: 'Pompes √† Chaleur',
            description: 'Chauffage & climatisation √©cologique',
            features: ['√âconomies 70%', 'Air/Eau ou Air/Air', 'COP √©lev√© >4.0', 'Subventions r√©gionales'],
            button: { text: 'En savoir plus', href: '#contact' }
          }
        ],
        style: { padding: '80px 24px' }
      }
    },
    {
      key: 'testimonials',
      type: 'testimonials',
      name: 'T√©moignages',
      displayOrder: 5,
      content: {
        title: {
          text: '‚≠ê Ce Que Nos Clients Disent',
          fontSize: 'clamp(28px, 6vw, 42px)'
        },
        items: [
          {
            rating: 5,
            text: 'Installation impeccable, √©quipe professionnelle. Nos panneaux produisent mieux que pr√©vu !',
            name: 'Marc Dubois',
            location: 'Charleroi'
          },
          {
            rating: 5,
            text: 'Du premier contact au suivi, tout √©tait parfait. La pompe fonctionne √† merveille.',
            name: 'Sophie Laurent',
            location: 'Fleurus'
          },
          {
            rating: 5,
            text: 'Tr√®s satisfait de mon installation PV + batterie. L\'√©quipe est tr√®s pro !',
            name: 'Jean Martin',
            location: 'Gosselies'
          }
        ],
        autoplay: true,
        autoplaySpeed: 5000,
        style: { backgroundColor: '#f9fafb', padding: '80px 24px' }
      }
    },
    {
      key: 'cta',
      type: 'cta',
      name: 'Appel √† l\'action',
      displayOrder: 6,
      content: {
        title: 'üåü Pr√™t √† Passer √† l\'√ânergie Verte ?',
        subtitle: 'Demandez votre devis gratuit et sans engagement\nR√©ponse sous 24h garantie',
        primaryButton: {
          text: '071/XX.XX.XX',
          href: 'tel:071XXXXXX',
          icon: 'PhoneOutlined',
          style: { padding: '16px 32px', backgroundColor: 'white', color: '#10b981' }
        },
        secondaryButton: {
          text: 'DEVIS EN LIGNE',
          href: '#contact',
          icon: 'MailOutlined',
          style: { padding: '16px 32px', borderColor: 'white', color: 'white', backgroundColor: 'rgba(255,255,255,0.1)' }
        },
        style: { background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)', padding: '80px 24px' }
      }
    },
    {
      key: 'footer',
      type: 'footer',
      name: 'Pied de page',
      displayOrder: 7,
      isLocked: true,
      content: {
        logo: {
          type: 'text',
          text: '2THIER ENERGY',
          emoji: '‚ö°',
          description: 'Votre partenaire en transition √©nerg√©tique depuis 2020'
        },
        columns: [
          {
            title: 'Solutions',
            links: [
              { label: 'Photovolta√Øque', url: '#services' },
              { label: 'Batteries', url: '#services' },
              { label: 'Bornes Recharge', url: '#services' },
              { label: 'Pompes √† Chaleur', url: '#services' }
            ]
          },
          {
            title: 'Entreprise',
            links: [
              { label: '√Ä propos', url: '#about' },
              { label: 'R√©alisations', url: '#projects' },
              { label: 'Blog', url: '#blog' },
              { label: 'Contact', url: '#contact' }
            ]
          },
          {
            title: 'Contact',
            links: [
              { label: '071/XX.XX.XX', url: 'tel:071XXXXXX' },
              { label: 'info@2thier.be', url: 'mailto:info@2thier.be' },
              { label: 'Lu-Ve: 8h-18h', url: '#' }
            ]
          }
        ],
        copyright: '¬© 2025 2Thier Energy - Tous droits r√©serv√©s ‚Ä¢ BE 0XXX.XXX.XXX',
        style: { background: '#1f2937', color: 'white', padding: '60px 24px 24px' }
      }
    }
  ];

  for (const section of sections) {
    await prisma.webSiteSection.create({
      data: {
        websiteId: website.id,
        ...section
      }
    });
  }
  console.log(`‚úÖ ${sections.length} sections cr√©√©es\n`);

  // 5Ô∏è‚É£ SERVICES
  console.log('‚ö° Cr√©ation des services...');
  const services = [
    {
      key: 'photovoltaique',
      icon: 'ThunderboltOutlined',
      title: 'Photovolta√Øque',
      description: 'Installation de panneaux solaires haute performance pour votre autonomie √©nerg√©tique',
      features: ['√âtude personnalis√©e gratuite', 'Panneaux garantis 25 ans', 'Monitoring en temps r√©el', 'Primes & d√©ductions fiscales'],
      ctaText: 'En savoir plus',
      ctaUrl: '#contact',
      displayOrder: 0
    },
    {
      key: 'batteries',
      icon: 'BulbOutlined',
      title: 'Batteries',
      description: 'Stockage d\'√©nergie pour maximiser votre autoconsommation',
      features: ['Autonomie jour & nuit', 'Compatible tout onduleur', 'Extension modulaire', 'Garantie 10 ans'],
      ctaText: 'En savoir plus',
      ctaUrl: '#contact',
      displayOrder: 1
    },
    {
      key: 'bornes',
      icon: 'CarOutlined',
      title: 'Bornes de Recharge',
      description: 'Rechargez votre v√©hicule √©lectrique √† domicile',
      features: ['Installation certifi√©e', 'Bornes intelligentes', 'Gestion via app', 'Primes disponibles'],
      ctaText: 'En savoir plus',
      ctaUrl: '#contact',
      displayOrder: 2
    },
    {
      key: 'pompes',
      icon: 'FireOutlined',
      title: 'Pompes √† Chaleur',
      description: 'Chauffage & climatisation √©cologique',
      features: ['√âconomies jusqu\'√† 70%', 'Air/Eau ou Air/Air', 'COP √©lev√© >4.0', 'Subventions r√©gionales'],
      ctaText: 'En savoir plus',
      ctaUrl: '#contact',
      displayOrder: 3
    }
  ];

  for (const service of services) {
    await prisma.webSiteService.create({
      data: {
        websiteId: website.id,
        ...service
      }
    });
  }
  console.log(`‚úÖ ${services.length} services cr√©√©s\n`);

  // 6Ô∏è‚É£ PROJETS
  console.log('üì∏ Cr√©ation des projets...');
  const projects = [
    {
      title: 'Installation 12 kWc + Batterie 10 kWh',
      location: 'Charleroi',
      details: 'Installation compl√®te avec monitoring et batterie pour autonomie maximale.',
      tags: ['Photovolta√Øque', 'Batterie', 'Monitoring'],
      isFeatured: true,
      displayOrder: 0
    },
    {
      title: 'Pompe √† Chaleur Air/Eau 16 kW',
      location: 'Fleurus',
      details: 'Remplacement chaudi√®re mazout par PAC haute performance.',
      tags: ['Pompe √† Chaleur', 'Chauffage'],
      isFeatured: true,
      displayOrder: 1
    },
    {
      title: 'Borne de Recharge 22 kW + PV',
      location: 'Gosselies',
      details: 'Installation panneaux solaires 8 kWc avec borne intelligente.',
      tags: ['Photovolta√Øque', 'Borne Recharge'],
      isFeatured: true,
      displayOrder: 2
    },
    {
      title: 'R√©novation √ânerg√©tique Compl√®te',
      location: 'Jumet',
      details: 'PV 15 kWc, PAC, isolation toiture, borne - projet cl√© en main.',
      tags: ['Photovolta√Øque', 'PAC', 'Isolation'],
      isFeatured: true,
      displayOrder: 3
    }
  ];

  for (const project of projects) {
    await prisma.webSiteProject.create({
      data: {
        websiteId: website.id,
        ...project
      }
    });
  }
  console.log(`‚úÖ ${projects.length} projets cr√©√©s\n`);

  // 7Ô∏è‚É£ T√âMOIGNAGES
  console.log('üí¨ Cr√©ation des t√©moignages...');
  const testimonials = [
    {
      customerName: 'Marc Dubois',
      location: 'Charleroi',
      service: 'Photovolta√Øque 10 kWc',
      rating: 5,
      text: 'Installation impeccable, √©quipe professionnelle. Nos panneaux produisent mieux que pr√©vu !',
      isFeatured: true,
      displayOrder: 0
    },
    {
      customerName: 'Sophie Laurent',
      location: 'Fleurus',
      service: 'Pompe √† Chaleur',
      rating: 5,
      text: 'Du premier contact au suivi, tout √©tait parfait. La pompe fonctionne √† merveille.',
      isFeatured: true,
      displayOrder: 1
    },
    {
      customerName: 'Jean Martin',
      location: 'Gosselies',
      service: 'Photovolta√Øque + Batterie',
      rating: 5,
      text: 'Tr√®s satisfait de mon installation. L\'√©quipe est tr√®s pro, je recommande !',
      isFeatured: true,
      displayOrder: 2
    },
    {
      customerName: 'Anne Dumont',
      location: 'Jumet',
      service: 'R√©novation compl√®te',
      rating: 5,
      text: 'Projet cl√© en main parfaitement g√©r√©. Notre maison est maintenant quasi autonome !',
      isFeatured: false,
      displayOrder: 3
    }
  ];

  for (const testimonial of testimonials) {
    await prisma.webSiteTestimonial.create({
      data: {
        websiteId: website.id,
        ...testimonial
      }
    });
  }
  console.log(`‚úÖ ${testimonials.length} t√©moignages cr√©√©s\n`);

  // 8Ô∏è‚É£ R√âSUM√â
  console.log('üéâ SEED TERMIN√â AVEC SUCC√àS !\n');
  console.log('üìä R√©sum√© :');
  console.log(`   ‚Ä¢ Site : ${website.siteName}`);
  console.log(`   ‚Ä¢ Slug : ${website.slug}`);
  console.log(`   ‚Ä¢ Sections : ${sections.length}`);
  console.log(`   ‚Ä¢ Services : ${services.length}`);
  console.log(`   ‚Ä¢ Projets : ${projects.length}`);
  console.log(`   ‚Ä¢ T√©moignages : ${testimonials.length}`);
  console.log('\n‚úÖ Le site est pr√™t ! Les renderers peuvent maintenant afficher le contenu.');
  console.log('üåê Test : http://localhost:5173/site-vitrine-2thier\n');
}

main()
  .catch((e) => {
    console.error('‚ùå ERREUR:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
