import{j as e}from"./index-C0S0DpaX.js";import{r}from"./react-vendor-Al_k-ZB6.js";import{u as s}from"./useAuthenticatedApi-BbQI8SDU.js";import{F as i,a,aG as n,B as m,aF as o,$ as t,ab as l,a0 as c,a$ as u,I as d,an as p,aC as g,aM as b,s as v,aH as N,b3 as D,b4 as C,b5 as h}from"./antd-vendor-zFcGztvE.js";const{TextArea:x}=d,{TabPane:P}=u,M=()=>{const{api:M}=s(),[E,V]=r.useState([]),[f,k]=r.useState(!1),[A,F]=r.useState(!1),[S,R]=r.useState(null),[O]=i.useForm(),j=[{id:"name",type:"text",label:"Nom complet",placeholder:"Votre nom",required:!0,order:1},{id:"email",type:"email",label:"Adresse email",placeholder:"votre@email.com",required:!0,order:2},{id:"phone",type:"tel",label:"Téléphone",placeholder:"+32 XXX XX XX XX",required:!1,order:3},{id:"message",type:"textarea",label:"Message",placeholder:"Votre message...",required:!0,order:4}];r.useEffect(()=>{(async()=>{try{k(!0);const e=await M.get("/api/public-forms");V(e)}catch(e){v.error("Erreur lors du chargement des formulaires")}finally{k(!1)}})()},[]);const U=e=>{e?(R(e),O.setFieldsValue({name:e.name,description:e.description,category:e.category,thankYouMessage:e.thankYouMessage,redirectUrl:e.redirectUrl,collectsRgpdConsent:e.collectsRgpdConsent,autoPublishLeads:e.autoPublishLeads,isActive:e.isActive})):(R(null),O.setFieldsValue({name:"",description:"",category:"contact",thankYouMessage:"Merci pour votre soumission !",collectsRgpdConsent:!0,autoPublishLeads:!1,isActive:!0})),F(!0)},y=[{title:"Nom",dataIndex:"name",key:"name",render:(r,s)=>e.jsxDEV(t,{direction:"vertical",size:0,children:[e.jsxDEV("strong",{children:r},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:209,columnNumber:11},void 0),s.description&&e.jsxDEV("span",{style:{fontSize:"12px",color:"#999"},children:s.description},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:211,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:208,columnNumber:9},void 0)},{title:"Catégorie",dataIndex:"category",key:"category",render:r=>e.jsxDEV(l,{children:{contact:"Contact",lead:"Lead",support:"Support",feedback:"Feedback"}[r]||r},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:227,columnNumber:16},void 0)},{title:"Soumissions",dataIndex:"submissionCount",key:"submissionCount",align:"center"},{title:"Statut",dataIndex:"isActive",key:"isActive",render:r=>e.jsxDEV(l,{color:r?"green":"red",children:r?"Actif":"Inactif"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:241,columnNumber:9},void 0)},{title:"Actions",key:"actions",render:(r,s)=>e.jsxDEV(t,{children:[e.jsxDEV(m,{icon:e.jsxDEV(N,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:250,columnNumber:19},void 0),size:"small",onClick:()=>(e=>{const r=`${window.location.origin}/form/${e}`;navigator.clipboard.writeText(r),v.success("URL copiée dans le presse-papier")})(s.slug),title:"Copier l'URL publique"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:249,columnNumber:11},void 0),e.jsxDEV(m,{icon:e.jsxDEV(D,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:256,columnNumber:19},void 0),size:"small",onClick:()=>U(s),title:"Éditer"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:255,columnNumber:11},void 0),e.jsxDEV(C,{title:"Supprimer ce formulaire ?",description:"Cette action est irréversible",onConfirm:()=>(async e=>{try{k(!0),await M.delete(`/api/public-forms/${e}`),v.success("Formulaire supprimé"),V(E.filter(r=>r.id!==e))}catch(r){v.error("Erreur lors de la suppression")}finally{k(!1)}})(s.id),okText:"Supprimer",cancelText:"Annuler",okButtonProps:{danger:!0},children:e.jsxDEV(m,{icon:e.jsxDEV(h,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:269,columnNumber:27},void 0),size:"small",danger:!0,title:"Supprimer"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:269,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:261,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:248,columnNumber:9},void 0)}];return e.jsxDEV("div",{style:{padding:"24px"},children:[e.jsxDEV(a,{title:e.jsxDEV(t,{children:[e.jsxDEV("span",{style:{fontSize:"20px",fontWeight:600},children:"Formulaires Publics"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:281,columnNumber:13},void 0),e.jsxDEV(l,{color:"blue",children:[E.length," formulaire(s)"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:282,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:280,columnNumber:11},void 0),extra:e.jsxDEV(m,{type:"primary",icon:e.jsxDEV(o,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:286,columnNumber:40},void 0),onClick:()=>U(),children:"Créer un formulaire"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:286,columnNumber:11},void 0),children:e.jsxDEV(n,{dataSource:E,columns:y,rowKey:"id",loading:f,pagination:{pageSize:10},locale:{emptyText:"Aucun formulaire créé"}},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:291,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:278,columnNumber:7},void 0),e.jsxDEV(c,{title:S?"Éditer le formulaire":"Créer un formulaire",open:A,onOk:async()=>{try{const e=await O.validateFields();if(k(!0),S){const r=await M.put(`/api/public-forms/${S.id}`,e);v.success("Formulaire mis à jour avec succès"),V(E.map(e=>e.id===S.id?r:e))}else{const r=await M.post("/api/public-forms",{...e,fields:j});v.success("Formulaire créé avec succès"),V([...E,r])}F(!1),O.resetFields()}catch(e){v.error("Erreur lors de la sauvegarde")}finally{k(!1)}},onCancel:()=>{F(!1),O.resetFields()},width:800,okText:"Enregistrer",cancelText:"Annuler",confirmLoading:f,children:[e.jsxDEV(i,{form:O,layout:"vertical",children:e.jsxDEV(u,{defaultActiveKey:"general",children:[e.jsxDEV(P,{tab:"Informations générales",children:[e.jsxDEV(i.Item,{name:"name",label:"Nom du formulaire",rules:[{required:!0,message:"Le nom est requis"}],children:e.jsxDEV(d,{placeholder:"Ex: Formulaire de contact"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:323,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:318,columnNumber:15},void 0),e.jsxDEV(i.Item,{name:"description",label:"Description",children:e.jsxDEV(x,{rows:2,placeholder:"Description courte du formulaire (optionnel)"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:327,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:326,columnNumber:15},void 0),e.jsxDEV(i.Item,{name:"category",label:"Catégorie",rules:[{required:!0,message:"La catégorie est requise"}],children:e.jsxDEV(p,{children:[e.jsxDEV(p.Option,{value:"contact",children:"Contact"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:339,columnNumber:19},void 0),e.jsxDEV(p.Option,{value:"lead",children:"Lead"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:340,columnNumber:19},void 0),e.jsxDEV(p.Option,{value:"support",children:"Support"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:341,columnNumber:19},void 0),e.jsxDEV(p.Option,{value:"feedback",children:"Feedback"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:342,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:338,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:333,columnNumber:15},void 0)]},"general",!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:317,columnNumber:13},void 0),e.jsxDEV(P,{tab:"Configuration",children:[e.jsxDEV(i.Item,{name:"thankYouMessage",label:"Message de remerciement",rules:[{required:!0,message:"Le message est requis"}],children:e.jsxDEV(x,{rows:3,placeholder:"Message affiché après soumission du formulaire"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:353,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:348,columnNumber:15},void 0),e.jsxDEV(i.Item,{name:"redirectUrl",label:"URL de redirection (optionnel)",children:e.jsxDEV(d,{placeholder:"https://example.com/merci"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:360,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:359,columnNumber:15},void 0),e.jsxDEV(g,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:363,columnNumber:15},void 0),e.jsxDEV(i.Item,{name:"collectsRgpdConsent",label:"Consentement RGPD",valuePropName:"checked",children:e.jsxDEV(b,{checkedChildren:"Oui",unCheckedChildren:"Non"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:370,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:365,columnNumber:15},void 0),e.jsxDEV(i.Item,{name:"autoPublishLeads",label:"Publier automatiquement les leads",valuePropName:"checked",children:e.jsxDEV(b,{checkedChildren:"Oui",unCheckedChildren:"Non"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:378,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:373,columnNumber:15},void 0),e.jsxDEV(i.Item,{name:"isActive",label:"Formulaire actif",valuePropName:"checked",children:e.jsxDEV(b,{checkedChildren:"Actif",unCheckedChildren:"Inactif"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:382,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:381,columnNumber:15},void 0)]},"config",!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:347,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:316,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:315,columnNumber:9},void 0),!S&&e.jsxDEV("div",{style:{marginTop:"16px",padding:"12px",background:"#f0f7ff",borderRadius:"4px"},children:[e.jsxDEV("strong",{children:"ℹ️ Champs par défaut inclus :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:397,columnNumber:13},void 0),e.jsxDEV("ul",{style:{marginTop:"8px",marginBottom:0},children:[e.jsxDEV("li",{children:"Nom complet (requis)"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:399,columnNumber:15},void 0),e.jsxDEV("li",{children:"Email (requis)"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:400,columnNumber:15},void 0),e.jsxDEV("li",{children:"Téléphone (optionnel)"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:401,columnNumber:15},void 0),e.jsxDEV("li",{children:"Message (requis)"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:402,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:398,columnNumber:13},void 0),e.jsxDEV("p",{style:{marginTop:"8px",marginBottom:0,fontSize:"12px",color:"#666"},children:"Vous pourrez personnaliser les champs après la création."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:404,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:389,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:302,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/PublicFormsManagementPage.tsx",lineNumber:277,columnNumber:5},void 0)};export{M as default};
