import{j as e}from"./index-C0S0DpaX.js";import{r as i}from"./react-vendor-Al_k-ZB6.js";import{u as n}from"./useAuthenticatedApi-BbQI8SDU.js";import{A as s,T as t,B as r,b9 as m,af as d,ag as o,a as l,$ as a,ab as u,bl as c,aA as v,a6 as D,b as g,a7 as p,I as h,cE as N}from"./antd-vendor-zFcGztvE.js";const{Title:b,Paragraph:x}=t;function A(){var A,C,f,E,V,S,I,k,R,O,U,j,M,y,w,z,_,G,T,L,P,$,q,B,F,W;const{message:H}=s.useApp(),K=n(),J=i.useMemo(()=>K.api,[]),[Q,X]=i.useState(null),[Y,Z]=i.useState(!1),[ee,ie]=i.useState(null),[ne,se]=i.useState(null),[te,re]=i.useState(null),[me,de]=i.useState("unknown"),[oe,le]=i.useState(null),[ae,ue]=i.useState(""),[ce,ve]=i.useState(null),De=i.useRef(null),ge=i.useRef(0),pe=i.useRef(!1),he=i.useRef(null);i.useEffect(()=>{he.current=oe},[oe]);const Ne=i.useRef(0),be=i.useCallback(async()=>{var e;if(pe.current)return;const i=Date.now();if(!(i<ge.current)){ge.current=i+1500,Ne.current=i;try{pe.current=!0;const i=await J.get("/api/integrations/advertising/google_ads/accounts"),n=null==i?void 0:i.data;if(null==n?void 0:n.integration){re(n.integration);const i=n.integration.config,s=null==(e=null==i?void 0:i.selectedAccount)?void 0:e.id;s&&"string"==typeof s&&ue(s)}else re(null),ue("");const s=(null==n?void 0:n.connectionState)??((null==n?void 0:n.integration)?"connected":"disconnected");if(de(s),se((null==n?void 0:n.diagnostics)||null),"missing_developer_token"===(null==n?void 0:n.disabledReason))ie("Google Ads: Developer Token manquant c√¥t√© serveur.");else if("missing_access_token"===(null==n?void 0:n.disabledReason))ie("Google Ads: access token indisponible ‚Äî refaites l'authentification OAuth.");else if("ads_api_error"===(null==n?void 0:n.disabledReason)){const e=(null==n?void 0:n.apiErrorSummary)||"Erreur Google Ads API";ie(`Google Ads API: ${e}`)}else Array.isArray(null==n?void 0:n.warnings)&&n.warnings.length?ie(String(n.warnings[0])):ie(null)}catch{re(null),se(null),de("disconnected")}finally{pe.current=!1}}},[J]),xe=i.useCallback(async()=>{Z(!0);try{const e=J.get("/api/integrations/status"),i=J.get("/api/integrations/advertising/env-check"),n=be(),[s,t]=await Promise.all([e,i]);X((null==s?void 0:s.data)||null),ve(t||null),await n}catch(e){H.error("Impossible de charger l'√©tat des int√©grations"),ve(null)}finally{Z(!1)}},[J,H,be]);i.useEffect(()=>{xe()},[xe]);const Ae="unknown"===me&&te?"connected":me,Ce="connected"===Ae,fe="error"===Ae,Ee=!!te,Ve=(null==ce?void 0:ce.ready)??!1,Se=(null==ce?void 0:ce.missing)??[],Ie=(null==ce?void 0:ce.warnings)??[],ke=null==(A=null==ce?void 0:ce.details)?void 0:A.google,Re=null==(C=null==ce?void 0:ce.details)?void 0:C.meta,Oe=(()=>{var e,i;const n=[...Ie],s=null==(e=null==ke?void 0:ke.redirectUri)?void 0:e.warning,t=null==(i=null==Re?void 0:Re.redirectUri)?void 0:i.warning;return s&&!n.includes(s)&&n.push(s),t&&!n.includes(t)&&n.push(t),n})(),Ue=Ve?{bg:"#f6ffed",border:"#b7eb8f",heading:"#389e0d",text:"#389e0d"}:{bg:"#fff1f0",border:"#ffa39e",heading:"#cf1322",text:"#cf1322"},je=i.useCallback(async e=>{var i,n;try{const n=await J.get(`/api/integrations/advertising/oauth/${e}/url`),s=(null==n?void 0:n.authUrl)??(null==(i=null==n?void 0:n.data)?void 0:i.authUrl);if(!s){const e="URL OAuth indisponible";return ie(e),void H.error(e)}const t=window.open(s,"ads_oauth","width=560,height=720");if(le({platform:e}),De.current){try{window.clearInterval(De.current)}catch{}De.current=null}let r=0;De.current=window.setInterval(()=>{r+=1,be(),r>10&&De.current&&(window.clearInterval(De.current),De.current=null)},1500);const m=i=>{const n=null==i?void 0:i.data,s=n&&"object"==typeof n?n:void 0;if(!!s&&("ads_oauth_done"===s.type||"oauth_done"===s.type||"google_ads_oauth_done"===s.type)&&(!(null==s?void 0:s.platform)||s.platform===e)){window.removeEventListener("message",m);try{t&&"function"==typeof t.close&&t.close()}catch{}if(De.current){try{window.clearInterval(De.current)}catch{}De.current=null}le(null),H.success(`OAuth ${e} termin√©`),xe(),be()}};window.addEventListener("message",m);const d=()=>{const i=he.current;i&&i.platform===e&&(be(),xe())};window.addEventListener("focus",d),setTimeout(()=>{if(window.removeEventListener("message",m),window.removeEventListener("focus",d),De.current){try{window.clearInterval(De.current)}catch{}De.current=null}le(null)},3e4)}catch(s){const e=(s&&"object"==typeof s?(null==(n=s.data)?void 0:n.message)||s.message:void 0)||"√âchec de l'init OAuth";ie(e),H.error(e)}},[J,xe,H,be]);return e.jsxDEV("div",{className:"p-6",children:[e.jsxDEV(t,{children:[e.jsxDEV(b,{level:3,children:"Int√©grations & Connecteurs"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:371,columnNumber:9},this),e.jsxDEV(x,{type:"secondary",children:"√âtat de connexion et derni√®res synchronisations."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:372,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:370,columnNumber:7},this),e.jsxDEV("div",{className:"mb-3",children:e.jsxDEV(r,{icon:e.jsxDEV(m,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:378,columnNumber:23},this),loading:Y,onClick:xe,children:"Rafra√Æchir"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:378,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:377,columnNumber:7},this),e.jsxDEV(d,{gutter:[16,16],children:[e.jsxDEV(o,{xs:24,md:12,lg:8,children:e.jsxDEV(l,{title:e.jsxDEV(a,{children:[e.jsxDEV(c,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:385,columnNumber:31},this)," Google Workspace"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:385,columnNumber:24},this),children:e.jsxDEV(a,{direction:"vertical",children:[e.jsxDEV("div",{children:["Statut: ",e.jsxDEV(u,{color:(null==(f=null==Q?void 0:Q.google)?void 0:f.enabled)?"green":"default",children:(null==(E=null==Q?void 0:Q.google)?void 0:E.enabled)?"Connect√©":"D√©connect√©"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:388,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:387,columnNumber:15},this),e.jsxDEV("div",{children:["Services: ",["gmail","calendar","drive","meet","sheets","voice"].map(i=>{var n;return e.jsxDEV(u,{color:(null==(n=null==Q?void 0:Q.google)?void 0:n[i])?"blue":"default",children:i},i,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:394,columnNumber:19},this)})]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:392,columnNumber:15},this),e.jsxDEV("div",{children:["Derni√®re sync: ",(null==(V=null==Q?void 0:Q.google)?void 0:V.lastSync)?new Date(Q.google.lastSync).toLocaleString():""]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:399,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:386,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:385,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:384,columnNumber:9},this),e.jsxDEV(o,{xs:24,md:12,lg:8,children:e.jsxDEV(l,{title:e.jsxDEV(a,{children:[e.jsxDEV(D,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:408,columnNumber:31},this)," Telnyx"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:408,columnNumber:24},this),children:[e.jsxDEV("div",{children:["Actif: ",e.jsxDEV(u,{color:(null==(S=null==Q?void 0:Q.telnyx)?void 0:S.active)?"green":"default",children:(null==(I=null==Q?void 0:Q.telnyx)?void 0:I.active)?"Oui":"Non"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:410,columnNumber:22},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:409,columnNumber:13},this),e.jsxDEV(v,{size:"small",dataSource:(null==(k=null==Q?void 0:Q.telnyx)?void 0:k.connections)||[],renderItem:i=>e.jsxDEV(v.Item,{children:e.jsxDEV(a,{children:[e.jsxDEV(u,{children:i.type},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:420,columnNumber:21},this),e.jsxDEV("span",{children:i.name},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:421,columnNumber:21},this),e.jsxDEV(u,{color:"active"===i.status?"green":"default",children:i.status},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:422,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:419,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:418,columnNumber:17},this)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:414,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:408,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:407,columnNumber:9},this),e.jsxDEV(o,{xs:24,md:24,lg:8,children:e.jsxDEV(l,{title:e.jsxDEV(a,{children:[e.jsxDEV(N,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:433,columnNumber:31},this)," Plateformes Ads"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:433,columnNumber:24},this),children:[e.jsxDEV(g,{type:Ce?"success":"warning",showIcon:!0,message:Ce?"‚úÖ Int√©gration Google Ads configur√©e":"‚ö†Ô∏è Configuration Google Ads requise",description:e.jsxDEV("div",{children:[(null==(R=null==te?void 0:te.name)?void 0:R.includes("OAuth error"))&&e.jsxDEV("div",{style:{marginBottom:12,padding:"12px",backgroundColor:"#fff7e6",border:"1px solid #ffd591",borderRadius:"4px"},children:[e.jsxDEV("p",{style:{margin:0,fontSize:"14px",fontWeight:"bold",color:"#d48806"},children:"üîß Action requise dans Google Cloud Console :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:442,columnNumber:23},this),e.jsxDEV("p",{style:{margin:"4px 0",fontSize:"12px",color:"#d48806"},children:["1. Allez sur ",e.jsxDEV("strong",{children:"console.cloud.google.com"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:446,columnNumber:38},this),e.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:446,columnNumber:79},this),"2. ",e.jsxDEV("strong",{children:"APIs & Services"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:447,columnNumber:28},this)," ‚Üí ",e.jsxDEV("strong",{children:"Library"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:447,columnNumber:63},this),e.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:447,columnNumber:87},this),'3. Cherchez "',e.jsxDEV("strong",{children:"Google Ads API"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:448,columnNumber:38},this),'" et ',e.jsxDEV("strong",{children:"activez-la"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:448,columnNumber:74},this),e.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:448,columnNumber:101},this),"4. R√©essayez la connexion OAuth"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:445,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:441,columnNumber:21},this),ce?e.jsxDEV("div",{style:{marginBottom:12,padding:"12px",backgroundColor:Ue.bg,border:`1px solid ${Ue.border}`,borderRadius:"4px"},children:[e.jsxDEV("p",{style:{margin:0,fontSize:"14px",fontWeight:"bold",color:Ue.heading},children:Ve?"Configuration Google Ads d√©tect√©e":"Variables Google Ads √† compl√©ter"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:455,columnNumber:17},this),e.jsxDEV("div",{style:{margin:"4px 0 0 0",fontSize:"12px",color:Ue.text},children:[e.jsxDEV("div",{children:["OAuth Client: ",(null==(O=null==ke?void 0:ke.clientId)?void 0:O.defined)?"OK"+((null==(U=null==ke?void 0:ke.clientId)?void 0:U.masked)?` (${ke.clientId.masked})`:""):"Manquant"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:459,columnNumber:19},this),e.jsxDEV("div",{children:["Developer token: ",(null==(j=null==ke?void 0:ke.developerToken)?void 0:j.defined)?`OK ‚Ä¢ empreinte ${(null==(M=null==ke?void 0:ke.developerToken)?void 0:M.fingerprint)??"n/a"}`:"Manquant"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:462,columnNumber:19},this),e.jsxDEV("div",{children:["Redirect URI: ",(null==(y=null==ke?void 0:ke.redirectUri)?void 0:y.value)||(null==ne?void 0:ne.redirectUri)||"non d√©fini",(null==(w=null==ke?void 0:ke.redirectUri)?void 0:w.sanitized)?" (nettoy√©)":""]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:465,columnNumber:19},this),e.jsxDEV("div",{children:["Version API: ",(null==(z=null==ke?void 0:ke.apiVersion)?void 0:z.value)||(null==ne?void 0:ne.apiVersion)||"v18",(null==(_=null==ke?void 0:ke.apiVersion)?void 0:_.defaultApplied)?" (valeur par d√©faut)":""]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:469,columnNumber:19},this),e.jsxDEV("div",{children:["Login customer ID: ",(null==(G=null==ke?void 0:ke.loginCustomerId)?void 0:G.formatted)||(null==(T=null==ke?void 0:ke.loginCustomerId)?void 0:T.normalized)||(null==ne?void 0:ne.loginCustomerIdSelected)||"non d√©fini"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:473,columnNumber:19},this),(null==(L=null==ke?void 0:ke.managerCustomerId)?void 0:L.formatted)&&e.jsxDEV("div",{children:["Manager customer ID: ",ke.managerCustomerId.formatted]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:477,columnNumber:21},this),Re&&e.jsxDEV("div",{style:{marginTop:6},children:[e.jsxDEV("strong",{children:"Meta Ads :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:481,columnNumber:23},this)," App ID ",(null==(P=Re.appId)?void 0:P.defined)?(null==($=Re.appId)?void 0:$.masked)||"OK":"manquante"," ‚Ä¢ Secret ",(null==(q=Re.appSecret)?void 0:q.defined)?`empreinte ${(null==(B=Re.appSecret)?void 0:B.fingerprint)??"n/a"}`:"manquant"," ‚Ä¢ Redirect ",(null==(F=Re.redirectUri)?void 0:F.value)||"non d√©fini"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:480,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:458,columnNumber:17},this),Se.length>0&&e.jsxDEV("div",{style:{marginTop:8,fontSize:"12px",color:Ue.heading},children:["Variables manquantes: ",Se.join(", ")]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:486,columnNumber:19},this),Oe.length>0&&e.jsxDEV("ul",{style:{marginTop:8,marginBottom:0,paddingLeft:18,fontSize:"12px",color:Ue.text},children:Oe.map((i,n)=>e.jsxDEV("li",{children:i},`${i}-${n}`,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:493,columnNumber:23},this))},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:491,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:454,columnNumber:15},this):e.jsxDEV("div",{style:{marginBottom:12,padding:"12px",backgroundColor:"#fafafa",border:"1px solid #d9d9d9",borderRadius:"4px",color:"#595959",fontSize:"12px"},children:"Analyse des variables d'environnement‚Ä¶"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:499,columnNumber:15},this),Ce?e.jsxDEV("div",{style:{marginBottom:12,padding:"12px",backgroundColor:"#f6ffed",border:"1px solid #b7eb8f",borderRadius:"4px"},children:[e.jsxDEV("p",{style:{margin:0,fontSize:"14px",fontWeight:"bold",color:"#389e0d"},children:"‚úÖ CONNECT√â via OAuth"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:507,columnNumber:23},this),Ee?e.jsxDEV(e.Fragment,{children:[e.jsxDEV("p",{style:{margin:"4px 0 0 0",fontSize:"12px",color:"#389e0d"},children:["Derni√®re connexion : ",(null==te?void 0:te.updatedAt)?new Date(te.updatedAt).toLocaleString("fr-FR"):"‚Äî"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:512,columnNumber:27},this),e.jsxDEV("p",{style:{margin:"4px 0 0 0",fontSize:"11px",color:"#666"},children:["Statut : ",(null==te?void 0:te.status)??"‚Äî",(null==te?void 0:te.name)?` ‚Ä¢ Nom : ${te.name}`:""]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:515,columnNumber:27},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:511,columnNumber:25},this):e.jsxDEV("p",{style:{margin:"4px 0 0 0",fontSize:"12px",color:"#389e0d"},children:"Connexion valid√©e ‚Äî en attente de la premi√®re synchronisation."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:520,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:506,columnNumber:21},this):fe&&Ee?e.jsxDEV("div",{style:{marginBottom:12,padding:"12px",backgroundColor:"#fff7e6",border:"1px solid #ffd591",borderRadius:"4px"},children:[e.jsxDEV("p",{style:{margin:0,fontSize:"14px",fontWeight:"bold",color:"#d48806"},children:["üî∂ Non connect√© ‚Äî ",(null==(W=te.credentials)?void 0:W.userError)||te.name]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:527,columnNumber:25},this),e.jsxDEV("p",{style:{margin:"4px 0",fontSize:"12px",color:"#d48806"},children:"Corrigez la configuration dans Google Cloud Console puis r√©essayez."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:530,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:526,columnNumber:23},this):null,e.jsxDEV(a,{wrap:!0,style:{marginTop:12},children:[e.jsxDEV(r,{size:"small",type:"primary",onClick:()=>window.open("https://ads.google.com/","_blank"),children:"Interface Google Ads"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:537,columnNumber:21},this),e.jsxDEV(r,{size:"small",onClick:()=>window.open("https://developers.google.com/google-ads/api/docs/first-call/overview","_blank"),children:"Documentation API"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:544,columnNumber:21},this),te&&e.jsxDEV(r,{size:"small",danger:!0,onClick:async()=>{try{await J.delete("/api/integrations/advertising/google_ads"),re(null),de("disconnected"),H.success("Connexion Google Ads supprim√©e")}catch{H.error("Erreur lors de la d√©connexion")}},children:"üîå D√©connecter"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:551,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:536,columnNumber:19},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:439,columnNumber:17},this),style:{marginBottom:16}},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:434,columnNumber:13},this),e.jsxDEV(a,{direction:"vertical",style:{width:"100%"},children:[ee&&e.jsxDEV(g,{type:"warning",showIcon:!0,closable:!0,onClose:()=>ie(null),message:ee},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:576,columnNumber:17},this),(null==ne?void 0:ne.humanHint)&&e.jsxDEV(g,{type:"info",showIcon:!0,message:"Aide Google Ads",description:e.jsxDEV("div",{style:{fontSize:12},children:[e.jsxDEV("div",{children:ne.humanHint},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:591,columnNumber:23},this),e.jsxDEV("div",{style:{opacity:.75,marginTop:6},children:["Dev token (empreinte): ",ne.devTokenFingerprint??"n/a"," ‚Ä¢ longueur: ",ne.devTokenLength??0,ne.clientIdMasked?e.jsxDEV(e.Fragment,{children:[" ‚Ä¢ OAuth client: ",ne.clientIdMasked]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:594,columnNumber:51},this):null,ne.apiVersion?e.jsxDEV(e.Fragment,{children:[" ‚Ä¢ API: ",ne.apiVersion]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:595,columnNumber:47},this):null,ne.loginCustomerIdSelected?e.jsxDEV(e.Fragment,{children:[" ‚Ä¢ login-customer-id s√©lectionn√©: ",ne.loginCustomerIdSelected]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:596,columnNumber:60},this):null,"boolean"==typeof ne.loginCustomerHeaderSent?e.jsxDEV(e.Fragment,{children:[" ‚Ä¢ header envoy√©: ",ne.loginCustomerHeaderSent?"oui":"non"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:597,columnNumber:81},this):null]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:592,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:590,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:585,columnNumber:17},this),e.jsxDEV(v,{size:"small",dataSource:(null==Q?void 0:Q.adPlatforms)||[],renderItem:i=>e.jsxDEV(v.Item,{children:[e.jsxDEV(a,{children:[e.jsxDEV(u,{children:i.platform},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:610,columnNumber:23},this),i.name&&e.jsxDEV("strong",{children:i.name},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:611,columnNumber:34},this),e.jsxDEV(u,{color:"connected"===i.status?"green":"default",children:i.status},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:612,columnNumber:23},this),e.jsxDEV("span",{children:["Derni√®re sync: ",i.lastSync?new Date(i.lastSync).toLocaleString():""]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:615,columnNumber:23},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:609,columnNumber:21},this),e.jsxDEV("div",{className:"mt-2 flex flex-wrap gap-2",children:[e.jsxDEV(r,{size:"small",type:"primary",onClick:()=>je(i.platform),children:"Se connecter via OAuth"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:621,columnNumber:23},this),"google_ads"===i.platform&&e.jsxDEV(a,{size:6,wrap:!0,children:[e.jsxDEV(p,{title:"ID client Google Ads (10 chiffres, tirets accept√©s)",children:e.jsxDEV(h,{size:"small",placeholder:"ID client (ex: 123-456-7890)",value:ae,onChange:e=>ue(e.target.value),style:{width:200}},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:631,columnNumber:29},this)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:630,columnNumber:27},this),e.jsxDEV(r,{size:"small",onClick:async()=>{const e=(ae||"").replace(/[^0-9]/g,"");if(e&&10===e.length)try{await J.post("/api/integrations/advertising/google_ads/select-account",{account:{id:ae}}),H.success("Compte Google Ads enregistr√©"),be()}catch(i){H.error("Impossible d'enregistrer le compte")}else H.warning("ID client invalide: entrez 10 chiffres (les tirets sont facultatifs)")},children:"Enregistrer le compte"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:639,columnNumber:27},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:629,columnNumber:25},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:620,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:608,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:604,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:574,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:433,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:432,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:383,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:369,columnNumber:5},this)}function C(){return e.jsxDEV(s,{children:e.jsxDEV(A,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:678,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/devis1minute/admin/Devis1minuteAdminIntegrations.tsx",lineNumber:677,columnNumber:5},this)}export{C as default};
