import{u as e,j as o}from"./index-C0S0DpaX.js";import{r as i,L as n}from"./react-vendor-Al_k-ZB6.js";import{u as s}from"./useAuthenticatedApi-BbQI8SDU.js";import{s as r,$ as t,ab as l,a7 as c,B as m,b9 as a,bg as d,a as u,b as v,bl as C,a3 as p,a4 as N,a2 as g,T as D,aC as b,cW as h,cB as x}from"./antd-vendor-zFcGztvE.js";const f=({showManualActions:n=!0,compact:g=!1,onConnectionChange:D})=>{const{connectionStatus:b,isLoading:h,triggerAutoConnection:x,refreshConnectionStatus:f,showConnectionStatus:E,openManualConnection:V}=(()=>{const{api:o}=s(),{user:n,currentOrganization:t}=e(),[l,c]=i.useState({isConnected:!1,needsReauth:!0}),[m,a]=i.useState(!1),d=i.useCallback(async()=>{if(!(null==n?void 0:n.id))return{isConnected:!1,needsReauth:!0};try{return await o.get(`/api/auto-google-auth/status?userId=${n.id}&organizationId=${(null==t?void 0:t.id)||""}`)}catch(e){return{isConnected:!1,needsReauth:!0}}},[o,null==n?void 0:n.id,null==t?void 0:t.id]),u=i.useCallback(async()=>{const e=await d();c(e)},[d]),v=i.useCallback(async()=>{if(!(null==n?void 0:n.id))return{success:!1,isConnected:!1,needsManualAuth:!0,message:"Utilisateur non connect√©"};a(!0);try{const e=await o.post("/api/auto-google-auth/connect",{userId:n.id,organizationId:null==t?void 0:t.id});return e.success&&e.isConnected?(r.success("Connexion Google automatique r√©ussie !"),await u()):e.needsManualAuth&&e.authUrl&&(r.info("Premi√®re connexion Google requise. Vous allez √™tre redirig√©..."),window.open(e.authUrl,"_blank","width=600,height=700")),e}catch(e){const o="Erreur lors de la connexion automatique √† Google";return r.error(o),{success:!1,isConnected:!1,needsManualAuth:!0,message:o}}finally{a(!1)}},[o,null==n?void 0:n.id,null==t?void 0:t.id,u]),C=i.useCallback(async()=>(await d()).isConnected,[d]),p=i.useCallback(()=>{if(l.isConnected){const e="workspace"===l.connectionType?"via Google Workspace":"organization"===l.connectionType?"via organisation":"personnelle";r.success(`Google connect√© (${e})`)}else r.warning("Google non connect√©. Connexion requise.")},[l]),N=i.useCallback(()=>{window.location.href="/profile"},[]);return i.useEffect(()=>{(null==n?void 0:n.id)?u():c({isConnected:!1,needsReauth:!0})},[null==n?void 0:n.id,null==t?void 0:t.id,u]),i.useEffect(()=>{const e=window.socketService;if(!e)return;const o=()=>{u(),r.success("Google Workspace connect√© automatiquement !")},i=()=>{r.info("Connexion Google requise. Cliquez ici pour vous connecter.",5)};return e.on("GOOGLE_AUTO_CONNECTED",o),e.on("GOOGLE_MANUAL_AUTH_REQUIRED",i),()=>{e.off("GOOGLE_AUTO_CONNECTED",o),e.off("GOOGLE_MANUAL_AUTH_REQUIRED",i)}},[u]),{connectionStatus:l,isLoading:m,getConnectionStatus:d,triggerAutoConnection:v,refreshConnectionStatus:u,checkGoogleConnection:C,showConnectionStatus:p,openManualConnection:N,isConnected:l.isConnected,needsReauth:l.needsReauth,connectionType:l.connectionType,lastConnected:l.lastConnected}})(),[S,A]=i.useState(new Date);i.useEffect(()=>{null==D||D(b.isConnected)},[b.isConnected,D]),i.useEffect(()=>{const e=setInterval(()=>{f(),A(new Date)},3e4);return()=>clearInterval(e)},[f]);const k=async()=>{await f(),A(new Date)},U=async()=>{await x(),A(new Date)},R=()=>b.isConnected?o.jsxDEV(p,{style:{color:"#52c41a"}},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:71,columnNumber:14},void 0):b.needsReauth?o.jsxDEV(N,{style:{color:"#faad14"}},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:74,columnNumber:14},void 0):o.jsxDEV(C,{style:{color:"#8c8c8c"}},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:76,columnNumber:12},void 0),M=()=>{if(b.isConnected){return`Connect√© (${"workspace"===b.connectionType?"Google Workspace":"organization"===b.connectionType?"Organisation":"Personnel"})`}return b.needsReauth?"Connexion requise":"Non connect√©"},O=()=>{if(b.lastConnected){const e=new Date(b.lastConnected);return`Derni√®re connexion: ${e.toLocaleDateString()} √† ${e.toLocaleTimeString()}`}return null};return g?o.jsxDEV(t,{size:"middle",children:[R(),o.jsxDEV(l,{color:b.isConnected?"success":b.needsReauth?"warning":"default",children:["Google: ",M()]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:106,columnNumber:9},void 0),n&&o.jsxDEV(t,{size:"small",children:[o.jsxDEV(c,{title:"Rafra√Æchir le statut",children:o.jsxDEV(m,{type:"text",size:"small",icon:o.jsxDEV(a,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:116,columnNumber:23},void 0),loading:h,onClick:k},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:113,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:112,columnNumber:13},void 0),!b.isConnected&&o.jsxDEV(c,{title:"Connecter Google",children:o.jsxDEV(m,{type:"text",size:"small",icon:o.jsxDEV(d,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:127,columnNumber:25},void 0),loading:h,onClick:U},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:124,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:123,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:111,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:104,columnNumber:7},void 0):o.jsxDEV(u,{title:o.jsxDEV(t,{children:[o.jsxDEV(C,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:143,columnNumber:11},void 0),"Connexion Automatique Google Workspace"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:142,columnNumber:9},void 0),extra:n&&o.jsxDEV(t,{children:[o.jsxDEV(c,{title:"Rafra√Æchir le statut",children:o.jsxDEV(m,{icon:o.jsxDEV(a,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:152,columnNumber:23},void 0),loading:h,onClick:k},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:151,columnNumber:15},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:150,columnNumber:13},void 0),o.jsxDEV(m,{type:"primary",icon:o.jsxDEV(C,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:160,columnNumber:21},void 0),loading:h,onClick:E,children:"Statut"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:158,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:149,columnNumber:11},void 0),style:{marginBottom:16},children:o.jsxDEV(t,{direction:"vertical",style:{width:"100%"},children:[o.jsxDEV(v,{type:b.isConnected?"success":b.needsReauth?"warning":"info",icon:R(),message:o.jsxDEV(t,{children:[o.jsxDEV("strong",{children:M()},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:178,columnNumber:15},void 0),b.isConnected&&o.jsxDEV(l,{color:"green",children:"Actif"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:180,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:177,columnNumber:13},void 0),description:o.jsxDEV("div",{children:b.isConnected?o.jsxDEV("div",{children:[o.jsxDEV("p",{children:"‚úÖ Votre compte Google Workspace est connect√© automatiquement."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:188,columnNumber:19},void 0),o.jsxDEV("p",{children:"Vous avez acc√®s √† Gmail, Calendar, Drive et toutes les applications Google."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:189,columnNumber:19},void 0),O()&&o.jsxDEV("small",{style:{color:"#8c8c8c"},children:O()},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:191,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:187,columnNumber:17},void 0):b.needsReauth?o.jsxDEV("div",{children:[o.jsxDEV("p",{children:"‚ö†Ô∏è Une connexion Google est requise pour acc√©der aux fonctionnalit√©s."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:196,columnNumber:19},void 0),o.jsxDEV("p",{children:'Cliquez sur "Connecter" pour autoriser l\'acc√®s automatique.'},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:197,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:195,columnNumber:17},void 0):o.jsxDEV("div",{children:[o.jsxDEV("p",{children:"‚ÑπÔ∏è Connexion Google non configur√©e."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:201,columnNumber:19},void 0),o.jsxDEV("p",{children:"Configurez votre compte Google pour b√©n√©ficier de l'int√©gration compl√®te."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:202,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:200,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:185,columnNumber:13},void 0),showIcon:!0},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:173,columnNumber:9},void 0),n&&o.jsxDEV(t,{wrap:!0,children:[!b.isConnected&&o.jsxDEV(o.Fragment,{children:[o.jsxDEV(m,{type:"primary",icon:o.jsxDEV(C,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:217,columnNumber:25},void 0),loading:h,onClick:U,children:"Connecter Automatiquement"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:215,columnNumber:17},void 0),o.jsxDEV(m,{icon:o.jsxDEV(d,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:225,columnNumber:25},void 0),onClick:V,children:"Connexion Manuelle"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:224,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:214,columnNumber:15},void 0),o.jsxDEV(m,{icon:o.jsxDEV(a,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:234,columnNumber:21},void 0),loading:h,onClick:k,children:"Actualiser"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:233,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:212,columnNumber:11},void 0),o.jsxDEV("div",{style:{fontSize:"12px",color:"#8c8c8c"},children:[o.jsxDEV("p",{children:["Derni√®re v√©rification: ",S.toLocaleTimeString()]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:245,columnNumber:11},void 0),o.jsxDEV("p",{children:["üí° ",o.jsxDEV("strong",{children:"Astuce:"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:247,columnNumber:16},void 0)," La connexion se fait automatiquement lors de votre connexion au CRM.",b.isConnected?" Vous n'avez plus besoin de vous connecter manuellement √† Google !":" Une fois configur√©e, vous n'aurez plus √† vous soucier de la connexion Google."]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:246,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:244,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:171,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleAutoConnectionStatus.tsx",lineNumber:140,columnNumber:5},void 0)},{Title:E,Text:V}=D,S=({organizationId:e})=>{var n,r,c,a,d,N,D,f,S,A,k,U,R;const{api:M}=s(),[O,j]=i.useState(!1),[G,P]=i.useState(null),[w,y]=i.useState(null),z=i.useCallback(async()=>{try{j(!0);const e=await M.get("/api/google-auth/status"),o=e.data||e;P({isConnected:o.connected,...o}),y(null)}catch(e){const o=e instanceof Error?e.message:"Erreur lors de la v√©rification du statut";y(o),P({isConnected:!1})}finally{j(!1)}},[M,e]);i.useEffect(()=>{z()},[z]);const T=e=>({"https://www.googleapis.com/auth/userinfo.email":"Profil (email)","https://www.googleapis.com/auth/userinfo.profile":"Profil (informations)","https://mail.google.com/":"Gmail (acc√®s complet)","https://www.googleapis.com/auth/gmail.readonly":"Gmail (lecture)","https://www.googleapis.com/auth/gmail.send":"Gmail (envoi)","https://www.googleapis.com/auth/gmail.modify":"Gmail (modification)","https://www.googleapis.com/auth/gmail.labels":"Gmail (√©tiquettes)","https://www.googleapis.com/auth/calendar":"Calendrier","https://www.googleapis.com/auth/calendar.events":"Calendrier (√©v√©nements)","https://www.googleapis.com/auth/drive":"Google Drive","https://www.googleapis.com/auth/documents":"Google Docs","https://www.googleapis.com/auth/spreadsheets":"Google Sheets","https://www.googleapis.com/auth/presentations":"Google Slides","https://www.googleapis.com/auth/meetings":"Google Meet","https://www.googleapis.com/auth/contacts":"Google Contacts","https://www.googleapis.com/auth/forms":"Google Forms","https://www.googleapis.com/auth/script.projects":"Apps Script","https://www.googleapis.com/auth/admin.directory.user":"Admin Utilisateurs","https://www.googleapis.com/auth/admin.directory.group":"Admin Groupes","https://www.googleapis.com/auth/admin.directory.orgunit":"Admin Unit√©s","https://www.googleapis.com/auth/admin.directory.resource.calendar":"Admin Ressources"}[e]||e);return O&&!G?o.jsxDEV(u,{title:"Connexion Google Workspace",children:o.jsxDEV("div",{style:{textAlign:"center",padding:"20px"},children:[o.jsxDEV(g,{size:"large"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:212,columnNumber:11},void 0),o.jsxDEV("div",{style:{marginTop:16},children:o.jsxDEV(V,{children:"V√©rification du statut de connexion..."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:214,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:213,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:211,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:210,columnNumber:7},void 0):o.jsxDEV(u,{title:o.jsxDEV(t,{children:[o.jsxDEV(C,{style:{color:"#4285f4"}},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:225,columnNumber:11},void 0),o.jsxDEV("span",{children:"Connexion Google Workspace"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:226,columnNumber:11},void 0),(null==G?void 0:G.isConnected)&&o.jsxDEV(l,{color:"success",icon:o.jsxDEV(p,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:228,columnNumber:40},void 0),children:"Connect√©"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:228,columnNumber:13},void 0),!1===(null==G?void 0:G.isConnected)&&o.jsxDEV(l,{color:"error",icon:o.jsxDEV(x,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:233,columnNumber:38},void 0),children:"Non connect√©"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:233,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:224,columnNumber:9},void 0),extra:(null==G?void 0:G.isConnected)?o.jsxDEV(m,{type:"default",danger:!0,icon:o.jsxDEV(h,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:244,columnNumber:19},void 0),loading:O,onClick:async()=>{try{j(!0),await M.post("/api/google-auth/disconnect",{organizationId:e}),P({isConnected:!1}),y(null)}catch(o){const e=o instanceof Error?o.message:"Erreur lors de la d√©connexion";y(e)}finally{j(!1)}},children:"D√©connecter"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:241,columnNumber:11},void 0):o.jsxDEV(m,{type:"primary",icon:o.jsxDEV(C,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:253,columnNumber:19},void 0),loading:O,onClick:async()=>{var o;try{j(!0);const i=e?`/google-auth/connect?organizationId=${e}`:"/google-auth/connect",n=await M.get(i);if(!n)return void y("R√©ponse vide du serveur");const s=(null==(o=null==n?void 0:n.data)?void 0:o.authUrl)||(null==n?void 0:n.authUrl);if(!s)return void y("URL d'authentification manquante");const r=window.open(s,"google-auth","width=500,height=600,scrollbars=yes,resizable=yes"),t=setInterval(()=>{(null==r?void 0:r.closed)&&(clearInterval(t),setTimeout(()=>{z()},1e3))},1e3)}catch(i){const e=i instanceof Error?i.message:"Erreur lors de la connexion";y(e)}finally{j(!1)}},children:"Connecter Google"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:251,columnNumber:11},void 0),children:[w&&o.jsxDEV(v,{message:"Erreur",description:w,type:"error",closable:!0,onClose:()=>y(null),style:{marginBottom:16}},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:263,columnNumber:9},void 0),(null==G?void 0:G.isConnected)?o.jsxDEV("div",{children:o.jsxDEV(t,{direction:"vertical",size:"middle",style:{width:"100%"},children:[o.jsxDEV("div",{children:[o.jsxDEV(V,{strong:!0,children:"Statut de connexion :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:278,columnNumber:15},void 0),o.jsxDEV("div",{style:{marginTop:4},children:["personal"===G.accessType&&o.jsxDEV(l,{color:"blue",icon:o.jsxDEV(p,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:281,columnNumber:43},void 0),children:"Connexion personnelle"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:281,columnNumber:19},void 0),"organization"===G.accessType&&o.jsxDEV(l,{color:"green",icon:o.jsxDEV(p,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:286,columnNumber:44},void 0),children:"Connexion via organisation"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:286,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:279,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:277,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV(V,{strong:!0,children:"Compte Google utilis√© :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:295,columnNumber:15},void 0),o.jsxDEV("div",{style:{marginTop:4},children:[o.jsxDEV(V,{children:(null==(n=G.userInfo)?void 0:n.email)||(null==(c=null==(r=G.organizationInfo)?void 0:r.userInfo)?void 0:c.email)||G.email||"Email non disponible"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:297,columnNumber:17},void 0),(null==(a=G.organizationInfo)?void 0:a.primaryUser)&&"organization"===G.accessType&&o.jsxDEV("div",{style:{marginTop:4,fontSize:"12px",color:"#666"},children:["Connect√© par ",G.organizationInfo.primaryUser.email,"(",G.organizationInfo.primaryUser.role,")"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:303,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:296,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:294,columnNumber:13},void 0),(G.connectedAt||(null==(N=null==(d=G.organizationInfo)?void 0:d.primaryUser)?void 0:N.connectedAt))&&o.jsxDEV("div",{children:[o.jsxDEV(V,{strong:!0,children:"Connect√© depuis :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:314,columnNumber:17},void 0),o.jsxDEV("div",{style:{marginTop:4},children:o.jsxDEV(V,{children:new Date(G.connectedAt||(null==(f=null==(D=G.organizationInfo)?void 0:D.primaryUser)?void 0:f.connectedAt)||"").toLocaleString()},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:316,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:315,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:313,columnNumber:15},void 0),(G.lastSync||(null==(A=null==(S=G.organizationInfo)?void 0:S.primaryUser)?void 0:A.lastSync))&&o.jsxDEV("div",{children:[o.jsxDEV(V,{strong:!0,children:"Derni√®re synchronisation :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:329,columnNumber:17},void 0),o.jsxDEV("div",{style:{marginTop:4},children:o.jsxDEV(V,{children:new Date(G.lastSync||(null==(U=null==(k=G.organizationInfo)?void 0:k.primaryUser)?void 0:U.lastSync)||"").toLocaleString()},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:331,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:330,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:328,columnNumber:15},void 0),o.jsxDEV(b,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:341,columnNumber:13},void 0),o.jsxDEV("div",{children:[o.jsxDEV(V,{strong:!0,children:"Permissions accord√©es :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:345,columnNumber:15},void 0),o.jsxDEV("div",{style:{marginTop:8},children:o.jsxDEV(t,{wrap:!0,children:(G.scopes||(null==(R=G.organizationInfo)?void 0:R.scopes)||[]).map((e,i)=>o.jsxDEV(l,{color:"blue",children:T(e)},i,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:349,columnNumber:21},void 0))||o.jsxDEV(V,{type:"secondary",children:"Aucune information sur les permissions"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:353,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:347,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:346,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:344,columnNumber:13},void 0),G.organizationInfo&&"organization"===G.accessType&&o.jsxDEV("div",{children:[o.jsxDEV(V,{strong:!0,children:"Utilisateurs connect√©s dans l'organisation :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:362,columnNumber:17},void 0),o.jsxDEV("div",{style:{marginTop:4},children:o.jsxDEV(l,{color:"cyan",children:[G.organizationInfo.connectedUsers," utilisateur(s)"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:364,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:363,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:361,columnNumber:15},void 0),o.jsxDEV(v,{message:"Connexion active",description:"personal"===G.accessType?"Votre compte Google personnel est connect√©. Vous pouvez utiliser toutes les fonctionnalit√©s Google dans le CRM.":"Vous utilisez la connexion Google de votre organisation. Toutes les fonctionnalit√©s Google sont disponibles.",type:"success",showIcon:!0},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:371,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:275,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:274,columnNumber:9},void 0):o.jsxDEV("div",{children:[o.jsxDEV(v,{message:"Connexion requise",description:"Connectez votre compte Google Workspace pour utiliser Gmail, Calendar, Drive et Meet directement dans le CRM.",type:"info",showIcon:!0,style:{marginBottom:16}},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:385,columnNumber:11},void 0),o.jsxDEV(E,{level:5,children:"Fonctionnalit√©s disponibles apr√®s connexion :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:393,columnNumber:11},void 0),o.jsxDEV("ul",{children:[o.jsxDEV("li",{children:["üìß ",o.jsxDEV("strong",{children:"Gmail :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:395,columnNumber:20},void 0)," Gestion des emails, envoi, r√©ception et organisation"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:395,columnNumber:13},void 0),o.jsxDEV("li",{children:["üìÖ ",o.jsxDEV("strong",{children:"Calendar :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:396,columnNumber:20},void 0)," Synchronisation des √©v√©nements et cr√©ation de r√©unions"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:396,columnNumber:13},void 0),o.jsxDEV("li",{children:["üíæ ",o.jsxDEV("strong",{children:"Drive :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:397,columnNumber:20},void 0)," Stockage et partage de fichiers"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:397,columnNumber:13},void 0),o.jsxDEV("li",{children:["üìπ ",o.jsxDEV("strong",{children:"Meet :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:398,columnNumber:20},void 0)," Cr√©ation et gestion des visioconf√©rences"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:398,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:394,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:384,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/GoogleConnectionCard.tsx",lineNumber:222,columnNumber:5},void 0)},A=()=>{const{currentOrganization:i,can:s}=e();return i?o.jsxDEV("div",{className:"bg-white p-8 rounded-lg shadow-md",children:[o.jsxDEV("h2",{className:"text-xl font-bold mb-4",children:"Mon Organisation"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:15,columnNumber:13},void 0),o.jsxDEV("p",{children:[o.jsxDEV("strong",{children:"Nom :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:16,columnNumber:16},void 0)," ",i.name]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:16,columnNumber:13},void 0),o.jsxDEV("p",{children:[o.jsxDEV("strong",{children:"Statut :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:17,columnNumber:16},void 0)," ",i.status||"Ind√©fini"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:17,columnNumber:13},void 0),o.jsxDEV("div",{className:"mt-4",children:s("organization:read")&&o.jsxDEV(n,{to:"/settings/organization",className:"text-indigo-600 hover:text-indigo-800",children:"G√©rer l'organisation"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:20,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:18,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:14,columnNumber:9},void 0):o.jsxDEV("div",{children:"Chargement des informations de l'organisation..."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:11,columnNumber:38},void 0)},k=()=>o.jsxDEV("div",{className:"bg-white p-8 rounded-lg shadow-md",children:[o.jsxDEV("h2",{className:"text-xl font-bold mb-6",children:"Int√©gration Google Workspace"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:32,columnNumber:13},void 0),o.jsxDEV("div",{className:"mb-6",children:[o.jsxDEV("h3",{className:"text-lg font-medium mb-4",children:"Connexion automatique"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:36,columnNumber:17},void 0),o.jsxDEV(f,{showManualActions:!0},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:37,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:35,columnNumber:13},void 0),o.jsxDEV("div",{className:"mb-6",children:[o.jsxDEV("h3",{className:"text-lg font-medium mb-4",children:"D√©tails de connexion"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:44,columnNumber:17},void 0),o.jsxDEV(S,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:45,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:43,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:31,columnNumber:9},void 0),U=()=>{const{user:s,isSuperAdmin:r,currentOrganization:t,can:l}=e(),[c,m]=i.useState(null),[a,d]=i.useState(!0);return i.useEffect(()=>{r?d(!1):t&&t.role?(m(t.role),d(!1)):d(!1)},[r,t]),a?o.jsxDEV("div",{children:"Chargement du r√¥le et des permissions..."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:71,columnNumber:25},void 0):s?r?o.jsxDEV("div",{className:"bg-white p-8 rounded-lg shadow-md",children:[o.jsxDEV("h2",{className:"text-xl font-bold mb-4",children:"Mon R√¥le : Super Administrateur"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:77,columnNumber:17},void 0),o.jsxDEV("p",{className:"mb-6 text-gray-600",children:"Vous disposez de toutes les permissions sur l'ensemble de la plateforme."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:78,columnNumber:17},void 0),o.jsxDEV("div",{className:"mt-6",children:o.jsxDEV(n,{to:"/admin/roles",className:"text-indigo-600 hover:text-indigo-800",children:"G√©rer les r√¥les globaux"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:80,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:79,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:76,columnNumber:13},void 0):c?o.jsxDEV("div",{className:"bg-white p-8 rounded-lg shadow-md",children:[o.jsxDEV("h2",{className:"text-xl font-bold mb-4",children:["Mon R√¥le : ",c.label||c.name]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:92,columnNumber:13},void 0),o.jsxDEV("p",{className:"mb-6 text-gray-600",children:c.description},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:93,columnNumber:13},void 0),o.jsxDEV("h3",{className:"text-lg font-bold mb-4",children:"Permissions associ√©es :"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:95,columnNumber:13},void 0),o.jsxDEV("p",{children:"Informations de permissions disponibles prochainement."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:96,columnNumber:13},void 0),o.jsxDEV("div",{className:"mt-6",children:l("role:read")&&o.jsxDEV(n,{to:"/settings/roles",className:"text-indigo-600 hover:text-indigo-800",children:"G√©rer les r√¥les de l'organisation"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:99,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:97,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:91,columnNumber:9},void 0):o.jsxDEV("div",{children:"Impossible de charger les informations du r√¥le ou aucun r√¥le n'est assign√© dans cette organisation."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:88,columnNumber:30},void 0):o.jsxDEV("div",{children:"Utilisateur non charg√©."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:72,columnNumber:23},void 0)},R=()=>{const{user:n,loading:r,refetchUser:t}=e(),{api:l}=s(),[c,m]=i.useState({firstName:"",lastName:"",avatarUrl:"",address:"",vatNumber:"",phoneNumber:""}),[a,d]=i.useState(!0),[u,v]=i.useState(""),[C,p]=i.useState(""),[N,g]=i.useState(null),D=i.useRef(null),[b,h]=i.useState("profile");i.useEffect(()=>{n&&(d(!0),l.get("/api/profile").then(e=>{m(e),d(!1)}).catch(e=>{v("Impossible de charger les informations du profil."),d(!1)}))},[n,l]);const x=e=>{const{name:o,value:i}=e.target;m(e=>({...e,[o]:i}))},f=e=>{e.target.files&&e.target.files[0]&&g(e.target.files[0])},E=async e=>{e.preventDefault(),v(""),p("");try{N&&await(async()=>{if(!N)return;const e=new FormData;e.append("avatar",N);try{const o=await l.post("/api/profile/avatar",e);m(e=>({...e,avatarUrl:o.avatarUrl})),g(null)}catch(o){throw new Error("Erreur lors du t√©l√©versement de l'avatar.")}})();const e=await l.put("/api/profile",c);m(e),p("Profil mis √† jour avec succ√®s !"),t&&t()}catch(o){const e=o instanceof Error?o.message:"Une erreur est survenue lors de la mise √† jour.";v(e)}};if(r||a)return o.jsxDEV("div",{className:"p-4",children:"Chargement du profil..."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:194,columnNumber:12},void 0);return o.jsxDEV("div",{className:"container mx-auto p-4",children:[o.jsxDEV("h1",{className:"text-3xl font-bold mb-8 text-gray-800",children:"Mon Compte"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:254,columnNumber:7},void 0),o.jsxDEV("div",{className:"mb-6 border-b border-gray-200",children:o.jsxDEV("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[o.jsxDEV("button",{onClick:()=>h("profile"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm "+("profile"===b?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-200"),children:"Profil"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:258,columnNumber:11},void 0),o.jsxDEV("button",{onClick:()=>h("organization"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm "+("organization"===b?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-200"),children:"Organisation"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:261,columnNumber:11},void 0),o.jsxDEV("button",{onClick:()=>h("permissions"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm "+("permissions"===b?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-200"),children:"R√¥le & Permissions"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:264,columnNumber:11},void 0),o.jsxDEV("button",{onClick:()=>h("google"),className:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm "+("google"===b?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-200"),children:"Google Workspace"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:267,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:257,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:256,columnNumber:7},void 0),o.jsxDEV("div",{children:(()=>{switch(b){case"profile":return o.jsxDEV("form",{onSubmit:E,className:"max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-md",children:[C&&o.jsxDEV("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4",role:"alert",children:C},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:202,columnNumber:33},void 0),u&&o.jsxDEV("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:u},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:203,columnNumber:31},void 0),o.jsxDEV("div",{className:"flex items-center space-x-6 mb-6",children:[o.jsxDEV("img",{src:c.avatarUrl||"https://placehold.co/100x100",alt:"Avatar",className:"w-24 h-24 rounded-full object-cover"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:206,columnNumber:25},void 0),o.jsxDEV("input",{type:"file",onChange:f,ref:D,className:"hidden"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:207,columnNumber:25},void 0),o.jsxDEV("button",{type:"button",onClick:()=>{var e;return null==(e=D.current)?void 0:e.click()},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Changer l'avatar"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:208,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:205,columnNumber:21},void 0),o.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxDEV("div",{children:[o.jsxDEV("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"Pr√©nom"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:213,columnNumber:29},void 0),o.jsxDEV("input",{type:"text",name:"firstName",id:"firstName",value:c.firstName||"",onChange:x,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:214,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:212,columnNumber:25},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Nom"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:217,columnNumber:29},void 0),o.jsxDEV("input",{type:"text",name:"lastName",id:"lastName",value:c.lastName||"",onChange:x,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:218,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:216,columnNumber:25},void 0),o.jsxDEV("div",{className:"md:col-span-2",children:[o.jsxDEV("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:"Adresse"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:221,columnNumber:29},void 0),o.jsxDEV("input",{type:"text",name:"address",id:"address",value:c.address||"",onChange:x,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:222,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:220,columnNumber:25},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{htmlFor:"vatNumber",className:"block text-sm font-medium text-gray-700",children:"Num√©ro de TVA"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:225,columnNumber:29},void 0),o.jsxDEV("input",{type:"text",name:"vatNumber",id:"vatNumber",value:c.vatNumber||"",onChange:x,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:226,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:224,columnNumber:25},void 0),o.jsxDEV("div",{children:[o.jsxDEV("label",{htmlFor:"phoneNumber",className:"block text-sm font-medium text-gray-700",children:"T√©l√©phone"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:229,columnNumber:29},void 0),o.jsxDEV("input",{type:"text",name:"phoneNumber",id:"phoneNumber",value:c.phoneNumber||"",onChange:x,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:230,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:228,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:211,columnNumber:21},void 0),o.jsxDEV("div",{className:"mt-8 flex justify-end",children:o.jsxDEV("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Enregistrer les modifications"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:235,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:234,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:201,columnNumber:17},void 0);case"organization":return o.jsxDEV(A,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:242,columnNumber:20},void 0);case"permissions":return o.jsxDEV(U,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:244,columnNumber:20},void 0);case"google":return o.jsxDEV(k,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:246,columnNumber:20},void 0);default:return null}})()},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:273,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/ProfilePage.tsx",lineNumber:253,columnNumber:5},void 0)};export{R as default};
