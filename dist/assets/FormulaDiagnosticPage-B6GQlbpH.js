import{j as e}from"./index-C0S0DpaX.js";import{r as i}from"./react-vendor-Al_k-ZB6.js";import{v as s,p as o}from"./formulaValidator-DVLkodcr.js";import"./antd-vendor-zFcGztvE.js";const l=()=>{const e=[];return e.push({id:"test-empty-formula",name:"Formule vide",sequence:[],targetProperty:"resultat",expression:"",targetFieldId:"field1"}),e.push({id:"test-single-field",name:"Un seul champ",sequence:[{id:"field-1",type:"field",value:"field1",label:"Champ 1",fieldId:"field1"}],targetProperty:"resultat",expression:"",targetFieldId:"field2"}),e.push({id:"test-addition",name:"Addition de deux champs",sequence:[{id:"field-1",type:"field",value:"field1",label:"Champ 1",fieldId:"field1"},{id:"op-1",type:"operator",value:"+",label:"+"},{id:"field-2",type:"field",value:"field2",label:"Champ 2",fieldId:"field2"}],targetProperty:"resultat",expression:"",targetFieldId:"field3"}),e.push({id:"test-comparison",name:"Comparaison de champs",sequence:[{id:"field-1",type:"field",value:"field1",label:"Champ 1",fieldId:"field1"},{id:"op-1",type:"operator",value:">",label:">"},{id:"field-2",type:"field",value:"field2",label:"Champ 2",fieldId:"field2"}],targetProperty:"resultat",expression:"",targetFieldId:"field4"}),e.push({id:"test-literal-value",name:"Formule avec valeur littérale",sequence:[{id:"field-1",type:"field",value:"field1",label:"Champ 1",fieldId:"field1"},{id:"op-1",type:"operator",value:"*",label:"*"},{id:"val-1",type:"value",value:100,label:"100"}],targetProperty:"resultat",expression:"",targetFieldId:"field5"}),e.push({id:"test-double-operator",name:"Formule avec double opérateur (invalide)",sequence:[{id:"field-1",type:"field",value:"field1",label:"Champ 1",fieldId:"field1"},{id:"op-1",type:"operator",value:"+",label:"+"},{id:"op-2",type:"operator",value:"*",label:"*"},{id:"field-2",type:"field",value:"field2",label:"Champ 2",fieldId:"field2"}],targetProperty:"resultat",expression:"",targetFieldId:"field6"}),e.push({id:"test-double-field",name:"Formule avec double champ (invalide)",sequence:[{id:"field-1",type:"field",value:"field1",label:"Champ 1",fieldId:"field1"},{id:"field-2",type:"field",value:"field2",label:"Champ 2",fieldId:"field2"}],targetProperty:"resultat",expression:"",targetFieldId:"field7"}),e.push({id:"test-complex",name:"Formule complexe",sequence:[{id:"field-1",type:"field",value:"field1",label:"Champ 1",fieldId:"field1"},{id:"op-1",type:"operator",value:"*",label:"*"},{id:"val-1",type:"value",value:2,label:"2"},{id:"op-2",type:"operator",value:"+",label:"+"},{id:"field-2",type:"field",value:"field2",label:"Champ 2",fieldId:"field2"}],targetProperty:"resultat",expression:"",targetFieldId:"field8"}),e},r=()=>{const[r,t]=i.useState(null),[d,a]=i.useState(null);i.useEffect(()=>{n()},[]);const n=()=>{const e=((e,i)=>{const s=l(),o=[];return s.forEach(s=>{const l=e(s,"TestRunner");let r;try{r=i(s,"TestRunner")}catch(t){r={error:t}}o.push({caseName:s.name,validationResult:l,preparationResult:r,isValid:l.isValid})}),o.filter(e=>e.isValid).length,o.forEach(e=>{e.isValid}),o})(s,o);t(e)},m=l();return e.jsxDEV("div",{className:"p-4",children:[e.jsxDEV("h1",{className:"text-xl font-bold mb-4",children:"Outil de diagnostic des formules"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:28,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex gap-4 mb-4",children:e.jsxDEV("button",{onClick:n,className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Exécuter les tests"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:31,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:30,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxDEV("div",{className:"border rounded p-4 bg-white",children:[e.jsxDEV("h2",{className:"text-lg font-semibold mb-2",children:"Cas de test disponibles"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:42,columnNumber:21},void 0),e.jsxDEV("div",{className:"space-y-2",children:m.map(i=>e.jsxDEV("div",{className:"p-2 border rounded cursor-pointer "+((null==d?void 0:d.id)===i.id?"border-blue-500 bg-blue-50":"hover:bg-gray-50"),onClick:()=>a(i),children:[e.jsxDEV("div",{className:"font-medium",children:i.name},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:50,columnNumber:33},void 0),e.jsxDEV("div",{className:"text-xs text-gray-500",children:[i.sequence.length," éléments"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:51,columnNumber:33},void 0)]},i.id,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:45,columnNumber:29},void 0))},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:43,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:41,columnNumber:17},void 0),e.jsxDEV("div",{className:"border rounded p-4 bg-white",children:[e.jsxDEV("h2",{className:"text-lg font-semibold mb-2",children:"Résultats des tests"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:59,columnNumber:21},void 0),r?e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"mb-4 p-2 bg-gray-100 rounded",children:[e.jsxDEV("span",{className:"font-medium",children:"Résumé: "},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:63,columnNumber:33},void 0),e.jsxDEV("span",{children:[r.filter(e=>e.isValid).length,"/",r.length," formules validées avec succès"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:64,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:62,columnNumber:29},void 0),e.jsxDEV("div",{className:"space-y-2",children:r.map((i,s)=>e.jsxDEV("div",{className:"p-2 border rounded "+(i.isValid?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),children:[e.jsxDEV("div",{className:"flex items-center",children:[e.jsxDEV("div",{className:"w-5 h-5 rounded-full flex items-center justify-center mr-2 "+(i.isValid?"bg-green-500":"bg-red-500"),children:e.jsxDEV("span",{className:"text-white text-xs",children:i.isValid?"✓":"✗"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:71,columnNumber:49},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:70,columnNumber:45},void 0),e.jsxDEV("div",{className:"font-medium",children:i.caseName},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:73,columnNumber:45},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:69,columnNumber:41},void 0),!i.isValid&&e.jsxDEV("div",{className:"text-sm text-red-600 mt-1",children:["Erreur: ",i.validationResult.message]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:76,columnNumber:45},void 0)]},s,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:68,columnNumber:37},void 0))},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:66,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:61,columnNumber:25},void 0):e.jsxDEV("div",{className:"text-gray-500",children:"Aucun test exécuté"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:85,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:58,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:39,columnNumber:13},void 0),d&&e.jsxDEV("div",{className:"mt-4 border rounded p-4 bg-white",children:[e.jsxDEV("h2",{className:"text-lg font-semibold mb-2",children:["Détails: ",d.name]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:93,columnNumber:21},void 0),e.jsxDEV("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxDEV("div",{children:[e.jsxDEV("h3",{className:"font-medium mb-2",children:"Structure de la formule"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:96,columnNumber:29},void 0),e.jsxDEV("pre",{className:"p-2 bg-gray-100 rounded text-xs overflow-auto max-h-80",children:JSON.stringify(d,null,2)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:97,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:95,columnNumber:25},void 0),e.jsxDEV("div",{children:[e.jsxDEV("h3",{className:"font-medium mb-2",children:"Validation manuelle"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:102,columnNumber:29},void 0),e.jsxDEV("button",{onClick:()=>{s(d,"DiagnosticTool");try{o(d,"DiagnosticTool")}catch(e){}},className:"px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Valider manuellement (voir console)"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:103,columnNumber:29},void 0),e.jsxDEV("div",{className:"mt-4",children:[e.jsxDEV("h3",{className:"font-medium mb-2",children:"Séquence d'éléments"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:120,columnNumber:33},void 0),e.jsxDEV("div",{className:"flex flex-wrap gap-2",children:d.sequence.map((i,s)=>e.jsxDEV("div",{className:"p-1 text-sm rounded border "+("field"===i.type?"bg-blue-100 border-blue-300":"operator"===i.type?"bg-yellow-100 border-yellow-300":"value"===i.type?"bg-green-100 border-green-300":"bg-gray-100 border-gray-300"),children:i.label||i.value},`${d.id}-seq-${s}`,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:123,columnNumber:41},void 0))},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:121,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:119,columnNumber:29},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:101,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:94,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:92,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/components/diagnostics/FormulaDiagnosticTool.tsx",lineNumber:27,columnNumber:9},void 0)},t=()=>e.jsxDEV("div",{className:"container mx-auto py-6 px-4",children:[e.jsxDEV("header",{className:"mb-6",children:[e.jsxDEV("h1",{className:"text-2xl font-bold mb-2",children:"Diagnostic des formules"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/Diagnostics/FormulaDiagnosticPage.tsx",lineNumber:11,columnNumber:17},void 0),e.jsxDEV("p",{className:"text-gray-600",children:"Utilisez cet outil pour tester et valider le comportement de l'éditeur de formules. Cette page est destinée aux développeurs uniquement."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/Diagnostics/FormulaDiagnosticPage.tsx",lineNumber:12,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/Diagnostics/FormulaDiagnosticPage.tsx",lineNumber:10,columnNumber:13},void 0),e.jsxDEV("main",{children:e.jsxDEV(r,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/Diagnostics/FormulaDiagnosticPage.tsx",lineNumber:19,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/Diagnostics/FormulaDiagnosticPage.tsx",lineNumber:18,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/Diagnostics/FormulaDiagnosticPage.tsx",lineNumber:9,columnNumber:9},void 0);export{t as default};
