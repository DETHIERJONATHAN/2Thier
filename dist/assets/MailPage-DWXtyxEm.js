import{u as e,j as s}from"./index-C0S0DpaX.js";import{r as i}from"./react-vendor-Al_k-ZB6.js";import{u as r}from"./useAuthenticatedApi-BbQI8SDU.js";import{F as m,a1 as o,B as t,L as a,b3 as n,a5 as l,bn as c,aQ as d,b0 as u,b5 as v,l as N,I as p,a2 as h,be as D,aA as y,T as x,u as b,a0 as C,s as E,$ as V,az as f,R as S,b as M}from"./antd-vendor-zFcGztvE.js";const{Sider:k,Content:j}=a,{Text:A}=x,{TextArea:R}=p,U=()=>{const{api:x}=r(),{user:M}=e(),[U,g]=i.useState("inbox"),[O,L]=i.useState([]),[G,w]=i.useState(null),[I,z]=i.useState(!0),[P,Y]=i.useState(null),[T,F]=i.useState(!1),[q,B]=i.useState(!1),[$,W]=i.useState(!1),[_]=m.useForm(),[H]=m.useForm(),K=i.useCallback(async e=>{z(!0),Y(null),w(null);try{const s=await x.get(`/emails?folder=${e}`);L(s||[])}catch(s){Y("Impossible de charger les emails. Veuillez r√©essayer."),L([])}finally{z(!1)}},[x]);i.useEffect(()=>{K(U)},[U,K]);return P?s.jsxDEV(o,{status:"error",title:"Erreur de connexion",subTitle:P,extra:s.jsxDEV(t,{type:"primary",onClick:()=>K(U),children:"R√©essayer"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:182,columnNumber:87},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:182,columnNumber:12},void 0):s.jsxDEV(a,{className:"h-full bg-white",children:[s.jsxDEV(k,{width:240,theme:"light",className:"border-r",children:[s.jsxDEV("div",{className:"p-4",children:s.jsxDEV(t,{type:"primary",icon:s.jsxDEV(n,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:189,columnNumber:40},void 0),block:!0,size:"large",onClick:()=>F(!0),children:"Nouveau message"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:189,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:188,columnNumber:9},void 0),s.jsxDEV(l,{mode:"inline",selectedKeys:[U],onSelect:({key:e})=>g(e),children:[s.jsxDEV(l.Item,{icon:s.jsxDEV(c,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:194,columnNumber:40},void 0),children:"Bo√Æte de r√©ception"},"inbox",!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:194,columnNumber:11},void 0),s.jsxDEV(l.Item,{icon:s.jsxDEV(d,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:195,columnNumber:39},void 0),children:"Envoy√©s"},"sent",!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:195,columnNumber:11},void 0),s.jsxDEV(l.Item,{icon:s.jsxDEV(u,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:196,columnNumber:41},void 0),children:"Brouillons"},"drafts",!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:196,columnNumber:11},void 0),s.jsxDEV(l.Item,{icon:s.jsxDEV(v,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:197,columnNumber:40},void 0),children:"Corbeille"},"trash",!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:193,columnNumber:9},void 0),s.jsxDEV("div",{className:"p-4 mt-auto",children:s.jsxDEV(t,{icon:s.jsxDEV(N,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:201,columnNumber:19},void 0),block:!0,onClick:()=>B(!0),children:"Param√®tres"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:200,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:199,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:187,columnNumber:7},void 0),s.jsxDEV(a,{children:[s.jsxDEV(k,{width:400,theme:"light",className:"border-r flex flex-col",children:[s.jsxDEV("div",{className:"p-2 border-b",children:s.jsxDEV(p.Search,{placeholder:"Rechercher..."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:212,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:211,columnNumber:11},void 0),I?s.jsxDEV("div",{className:"flex items-center justify-center flex-grow",children:s.jsxDEV(h,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:215,columnNumber:73},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:215,columnNumber:13},void 0):0===O.length?s.jsxDEV("div",{className:"flex items-center justify-center flex-grow",children:s.jsxDEV(D,{description:"Aucun email"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:217,columnNumber:73},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:217,columnNumber:13},void 0):s.jsxDEV(y,{className:"overflow-y-auto",dataSource:O,renderItem:e=>s.jsxDEV(y.Item,{onClick:()=>(async e=>{if(w(e),!e.isRead)try{L(s=>s.map(s=>s.id===e.id?{...s,isRead:!0}:s))}catch(s){}})(e),className:`p-4 cursor-pointer hover:bg-gray-100 ${(null==G?void 0:G.id)===e.id?"bg-blue-50":""} ${e.isRead?"":"font-semibold"}`,children:s.jsxDEV(y.Item.Meta,{avatar:s.jsxDEV(b,{children:e.from.charAt(0).toUpperCase()},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:228,columnNumber:29},void 0),title:s.jsxDEV(A,{strong:!e.isRead,children:e.from},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:229,columnNumber:28},void 0),description:s.jsxDEV(A,{ellipsis:!0,children:e.subject},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:230,columnNumber:34},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:227,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:223,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:219,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:210,columnNumber:9},void 0),s.jsxDEV(j,{children:G?s.jsxDEV("div",{className:"p-6 h-full flex flex-col",children:[s.jsxDEV("div",{className:"flex justify-between items-center mb-4 pb-4 border-b",children:[s.jsxDEV("h2",{className:"text-xl font-semibold m-0",children:G.subject},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:157,columnNumber:11},void 0),s.jsxDEV(f,{className:G.isStarred?"text-yellow-500":"text-gray-300"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:158,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:156,columnNumber:9},void 0),s.jsxDEV("div",{className:"flex items-center mb-6",children:[s.jsxDEV(b,{icon:s.jsxDEV(S,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:161,columnNumber:25},void 0),size:"large"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:161,columnNumber:11},void 0),s.jsxDEV("div",{className:"ml-4",children:[s.jsxDEV(A,{strong:!0,children:G.from},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:163,columnNumber:13},void 0),s.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:163,columnNumber:53},void 0),s.jsxDEV(A,{type:"secondary",className:"text-sm",children:["√Ä: ",null==M?void 0:M.email]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:164,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:162,columnNumber:11},void 0),s.jsxDEV("div",{className:"ml-auto text-right",children:s.jsxDEV(A,{type:"secondary",className:"text-sm",children:new Date(G.createdAt).toLocaleString("fr-FR")},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:167,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:166,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:160,columnNumber:9},void 0),s.jsxDEV("div",{className:"prose max-w-none flex-grow overflow-y-auto",dangerouslySetInnerHTML:{__html:G.body.replace(/\n/g,"<br />")}},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:170,columnNumber:9},void 0),s.jsxDEV("div",{className:"pt-4 mt-4 border-t",children:s.jsxDEV(V,{children:[s.jsxDEV(t,{type:"primary",children:"R√©pondre"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:173,columnNumber:13},void 0),s.jsxDEV(t,{children:"Transf√©rer"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:174,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:172,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:171,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:155,columnNumber:7},void 0):s.jsxDEV("div",{className:"flex items-center justify-center h-full text-gray-500",children:"S√©lectionnez un email pour le lire."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:152,columnNumber:14},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:237,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:209,columnNumber:7},void 0),s.jsxDEV(C,{title:"Nouveau message",open:T,onCancel:()=>F(!1),footer:null,width:700,children:s.jsxDEV(m,{form:_,layout:"vertical",onFinish:async e=>{E.loading({content:"Envoi en cours...",key:"sending"});try{await x.post("/yandex/send",{to:e.to,subject:e.subject,html:e.body.replace(/\n/g,"<br />")}),E.success({content:"Email envoy√© avec succ√®s !",key:"sending"}),F(!1),_.resetFields(),"sent"===U&&K("sent")}catch(s){E.error({content:"Erreur lors de l'envoi de l'email",key:"sending"})}},children:[s.jsxDEV(m.Item,{name:"to",label:"√Ä",rules:[{required:!0,type:"email"}],children:s.jsxDEV(p,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:244,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:243,columnNumber:11},void 0),s.jsxDEV(m.Item,{name:"subject",label:"Sujet",rules:[{required:!0}],children:s.jsxDEV(p,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:247,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:246,columnNumber:11},void 0),s.jsxDEV(m.Item,{name:"body",label:"Message",rules:[{required:!0}],children:s.jsxDEV(R,{rows:8},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:250,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:249,columnNumber:11},void 0),s.jsxDEV(m.Item,{children:s.jsxDEV(t,{type:"primary",htmlType:"submit",children:"Envoyer"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:253,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:252,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:242,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:241,columnNumber:7},void 0),s.jsxDEV(C,{title:"‚öôÔ∏è Configuration Email Yandex",open:q,onCancel:()=>B(!1),footer:[s.jsxDEV(t,{onClick:()=>B(!1),children:"Fermer"},"close",!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:264,columnNumber:11},void 0)],width:700,children:s.jsxDEV("div",{className:"space-y-6",children:[s.jsxDEV("div",{children:[s.jsxDEV(A,{strong:!0,children:"üìß Configuration Directe Yandex"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:272,columnNumber:13},void 0),s.jsxDEV("div",{className:"mt-2 p-3 bg-blue-50 rounded",children:[s.jsxDEV(A,{children:"Interface op√©rationnelle pour Yandex Mail"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:274,columnNumber:15},void 0),s.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:274,columnNumber:69},void 0),s.jsxDEV(A,{children:"Configurez votre compte Yandex pour envoyer et recevoir des emails directement."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:275,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:273,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:271,columnNumber:11},void 0),s.jsxDEV("div",{className:"p-4 border rounded",children:[s.jsxDEV(A,{strong:!0,children:"ÔøΩ Configuration Yandex"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:280,columnNumber:13},void 0),s.jsxDEV(t,{type:"primary",className:"ml-4",onClick:()=>{B(!1),W(!0)},children:"Configurer Yandex"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:281,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:279,columnNumber:11},void 0),s.jsxDEV("div",{className:"p-4 border rounded",children:[s.jsxDEV(A,{strong:!0,children:"üîÑ Synchronisation"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:294,columnNumber:13},void 0),s.jsxDEV("div",{className:"mt-2",children:[s.jsxDEV(t,{type:"primary",onClick:async()=>{E.loading({content:"Synchronisation Yandex...",key:"yandex-sync"});try{await x.post("/yandex/sync",{}),E.success({content:"Synchronisation r√©ussie !",key:"yandex-sync"}),K(U)}catch(e){E.error({content:"Erreur lors de la synchronisation",key:"yandex-sync"})}},className:"mr-2",children:"Synchroniser maintenant"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:296,columnNumber:15},void 0),s.jsxDEV(t,{onClick:async()=>{try{await x.post("/yandex/test",{}),E.success("Test de connexion Yandex r√©ussi !")}catch(e){E.error("Erreur de connexion Yandex - V√©rifiez votre configuration")}},children:"Tester la connexion"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:303,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:295,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:293,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:270,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:259,columnNumber:7},void 0),s.jsxDEV(C,{title:"üîß Configuration Yandex Mail",open:$,onCancel:()=>W(!1),footer:null,width:600,children:[s.jsxDEV("div",{className:"mb-4",children:s.jsxDEV(A,{type:"secondary",children:"Entrez vos identifiants Yandex pour activer l'envoi et la r√©ception d'emails directement depuis l'interface."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:330,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:329,columnNumber:9},void 0),s.jsxDEV(m,{form:H,layout:"vertical",onFinish:async e=>{E.loading({content:"Configuration Yandex en cours...",key:"yandex-setup"});try{await x.post("/yandex/setup",{email:e.email,password:e.password}),E.success({content:"Configuration Yandex r√©ussie !",key:"yandex-setup"}),W(!1),H.resetFields(),K(U)}catch(s){E.error({content:"Erreur lors de la configuration Yandex",key:"yandex-setup"})}},children:[s.jsxDEV(m.Item,{name:"email",label:"Adresse Email Yandex",rules:[{required:!0,message:"L'adresse email est requise"},{type:"email",message:"Format d'email invalide"}],children:s.jsxDEV(p,{placeholder:"votre-email@yandex.com"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:343,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:335,columnNumber:11},void 0),s.jsxDEV(m.Item,{name:"password",label:"Mot de passe d'application Yandex",rules:[{required:!0,message:"Le mot de passe est requis"}],children:s.jsxDEV(p.Password,{placeholder:"Mot de presse d'application"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:350,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:345,columnNumber:11},void 0),s.jsxDEV("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded",children:s.jsxDEV(A,{type:"warning",className:"text-sm",children:["‚ö†Ô∏è Utilisez un ",s.jsxDEV("strong",{children:"mot de passe d'application"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:354,columnNumber:30},void 0)," Yandex, pas votre mot de passe principal.",s.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:355,columnNumber:15},void 0),"Cr√©ez-le dans : Param√®tres Yandex ‚Üí S√©curit√© ‚Üí Mots de passe d'application"]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:353,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:352,columnNumber:11},void 0),s.jsxDEV(m.Item,{children:s.jsxDEV(V,{children:[s.jsxDEV(t,{type:"primary",htmlType:"submit",size:"large",children:"Configurer Yandex"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:361,columnNumber:15},void 0),s.jsxDEV(t,{onClick:()=>W(!1),size:"large",children:"Annuler"},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:364,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:360,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:359,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:334,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:322,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/mail-system/components/shared/GmailLayout.tsx",lineNumber:186,columnNumber:5},void 0)},{Text:g}=x,O=()=>{const[m,a]=E.useMessage(),{user:n}=e(),{api:l}=r(),[c,d]=i.useState(null),[u,v]=i.useState(!0),[N,p]=i.useState(null),[D,y]=i.useState(!1),x=i.useCallback(async()=>{if(n)try{const e=await l.get("/api/email-accounts/me");e.success&&e.hasAccount&&d(e.emailAccount)}catch(e){const s=e;s.response&&404===s.response.status?d(null):p("Impossible de v√©rifier la configuration de votre bo√Æte mail.")}finally{v(!1)}else v(!1)},[l,n]);i.useEffect(()=>{x()},[x]);const b=i.useCallback(async()=>{var e,s;y(!0),p(null);try{const e=await l.post("/api/email-accounts",{});e.success&&(d(e.emailAccount),m.success("Votre bo√Æte mail a √©t√© activ√©e avec succ√®s !"))}catch(i){const r=(null==(s=null==(e=i.response)?void 0:e.data)?void 0:s.error)||"Une erreur est survenue lors de l'activation.";p(r),m.error(r)}finally{y(!1)}},[l,m]);return u?s.jsxDEV("div",{className:"flex justify-center items-center h-full",children:s.jsxDEV(h,{size:"large",tip:"V√©rification de la configuration...",children:s.jsxDEV("div",{style:{width:1,height:1}},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:81,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:80,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:79,columnNumber:7},void 0):c?s.jsxDEV("div",{style:{height:"100vh",display:"flex",flexDirection:"column"},children:[s.jsxDEV("div",{style:{background:"#001529",color:"white",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxDEV(g,{style:{color:"white",fontWeight:"bold"},children:["üìß ",c.emailAddress]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:98,columnNumber:11},void 0),c.organization&&s.jsxDEV(g,{style:{color:"#87d068",fontSize:"12px"},children:c.organization.name},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:102,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:90,columnNumber:9},void 0),s.jsxDEV("div",{style:{flex:1},children:s.jsxDEV(U,{},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:109,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:89,columnNumber:7},void 0):s.jsxDEV("div",{className:"flex items-center justify-center h-full bg-gray-50",children:[a,s.jsxDEV("div",{style:{maxWidth:"600px",width:"100%",padding:"20px"},children:[N&&s.jsxDEV(M,{message:"Erreur",description:N,type:"error",style:{marginBottom:"24px"},showIcon:!0},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:120,columnNumber:11},void 0),s.jsxDEV(o,{status:"info",title:"üöÄ Votre Bo√Æte Mail Professionnelle",subTitle:"Activez votre compte pour commencer √† envoyer et recevoir des emails directement depuis le CRM avec votre adresse professionnelle.",extra:[s.jsxDEV(t,{type:"primary",onClick:b,loading:D,size:"large",style:{height:"48px",paddingLeft:"32px",paddingRight:"32px",fontSize:"16px"},children:D?"Cr√©ation en cours...":"Activer ma bo√Æte mail"},"activate",!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:134,columnNumber:13},void 0)]},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:129,columnNumber:9},void 0),s.jsxDEV("div",{style:{marginTop:"32px",textAlign:"center"},children:s.jsxDEV(g,{type:"secondary",style:{fontSize:"14px"},children:"Un compte email professionnel sera cr√©√© automatiquement avec votre nom et pr√©nom."},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:153,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:152,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:118,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/dethi/OneDrive/Desktop/CRM SAVE/crm/src/pages/MailPage.tsx",lineNumber:116,columnNumber:5},void 0)};export{O as default};
