#!/bin/bash

# 🧪 TEST FINAL - Persistance images ORIGINAL + DUPLIQUÉ

echo "═══════════════════════════════════════════════════════════"
echo "🧪 TEST FINAL - Persistance images ORIGINAL + DUPLIQUÉ"
echo "═══════════════════════════════════════════════════════════"
echo ""
echo "📝 PLAN:"
echo ""
echo "ÉTAPE 1: NŒUD ORIGINAL"
echo "────────────────────────"
echo "1. Créer un nœud IMAGE avec ID: abc123"
echo "2. Uploader photo + mesurer"
echo "3. Console doit afficher:"
echo "   💾 SAVE sessionStorage"
echo "   Clé: tbl_image_annot_abc123"
echo ""
echo "ÉTAPE 2: DUPLIQUER LE NŒUD"
echo "────────────────────────"
echo "1. Dupliquer → Nouveau ID: abc123-1"
echo "2. Console doit afficher:"
echo "   🔄 SYNC ORIGINAL: tbl_image_annot_abc123"
echo "      ✅ SAUVEGARDÉE"
echo ""
echo "   ✅ Cela signifie que l'image annotée a été sauvegardée DANS LES DEUX clés:"
echo "      - tbl_image_annot_abc123   (nœud ORIGINAL)"
echo "      - tbl_image_annot_abc123-1 (nœud DUPLIQUÉ)"
echo ""
echo "ÉTAPE 3: RECHARGER (F5)"
echo "────────────────────────"
echo "1. NŒUD ORIGINAL (abc123) doit afficher l'image annotée"
echo "2. NŒUD DUPLIQUÉ (abc123-1) doit afficher l'image annotée"
echo ""
echo "🔍 DEVTOOLS CONSOLE - Vérifier:"
echo "────────────────────────"
echo "  sessionStorage.getItem('tbl_image_annot_abc123')?.length"
echo "  sessionStorage.getItem('tbl_image_annot_abc123-1')?.length"
echo ""
echo "  ✅ Les DEUX doivent retourner une taille > 100000 (image de 192KB)"
echo ""
echo "═══════════════════════════════════════════════════════════"
echo ""
